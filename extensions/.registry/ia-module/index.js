import{useApi as e,defineModule as n}from"@directus/extensions-sdk";import{ref as a,provide as t,inject as r,createElementBlock as i,openBlock as o,createElementVNode as l,toDisplayString as s,createVNode as d,unref as c,watch as u,withModifiers as p,withDirectives as f,createCommentVNode as v,vModelText as b,computed as g,onMounted as m,createBlock as h,Fragment as x,renderList as y,resolveComponent as w,withKeys as k,normalizeClass as _,withCtx as z,createTextVNode as C,onUnmounted as E,isRef as S,vModelSelect as A,resolveDirective as I}from"vue";const q=Symbol("azienda");function R(){const e=r(q,null);return e||{selectedAzienda:a(null),setAzienda:()=>{}}}function O(e,n){return o(),i("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5m-13.5-9L12 3m0 0 4.5 4.5M12 3v13.5"})])}function j(e,n){return o(),i("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M2.036 12.322a1.012 1.012 0 0 1 0-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178Z"}),l("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"})])}function F(e,n){return o(),i("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"})])}var T=[],D=[];function L(e,n){if(e&&"undefined"!=typeof document){var a,t=!0===n.prepend?"prepend":"append",r=!0===n.singleTag,i="string"==typeof n.container?document.querySelector(n.container):document.getElementsByTagName("head")[0];if(r){var o=T.indexOf(i);-1===o&&(o=T.push(i)-1,D[o]={}),a=D[o]&&D[o][t]?D[o][t]:D[o][t]=l()}else a=l();65279===e.charCodeAt(0)&&(e=e.substring(1)),a.styleSheet?a.styleSheet.cssText+=e:a.appendChild(document.createTextNode(e))}function l(){var e=document.createElement("style");if(e.setAttribute("type","text/css"),n.attributes)for(var a=Object.keys(n.attributes),r=0;r<a.length;r++)e.setAttribute(a[r],n.attributes[a[r]]);var o="prepend"===t?"afterbegin":"beforeend";return i.insertAdjacentElement(o,e),e}}L("\n.faq-card[data-v-2ca7b171] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 16px 20px;\n  border: 1px solid var(--border-color-subdued, #e5e7eb);\n  border-radius: 12px;\n  margin-bottom: 12px;\n  background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%);\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.04);\n  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n}\n.faq-card[data-v-2ca7b171]:hover {\n  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.08);\n  transform: translateY(-1px);\n  border-color: var(--border-color, #d1d5db);\n}\n.faq-content[data-v-2ca7b171] {\n  flex: 1;\n  padding-right: 16px;\n  min-width: 0;\n}\n.faq-content h4[data-v-2ca7b171] {\n  margin: 0 0 6px 0;\n  font-size: 15px;\n  font-weight: 600;\n  color: var(--foreground, #1a1a1a);\n  letter-spacing: -0.01em;\n  line-height: 1.4;\n}\n.faq-content .preview[data-v-2ca7b171] {\n  margin: 0;\n  font-size: 13px;\n  color: var(--foreground-subdued, #6b7280);\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  line-height: 1.5;\n}\n.faq-actions[data-v-2ca7b171] {\n  display: flex;\n  gap: 8px;\n  align-items: center;\n}\n.icon-btn[data-v-2ca7b171] {\n  width: 40px;\n  height: 40px;\n  border-radius: 10px;\n  border: 1px solid var(--border-color-subdued, #e5e7eb);\n  background: var(--background, #ffffff);\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);\n}\n.icon-btn[data-v-2ca7b171]:hover {\n  background: var(--background-subdued, #f9fafb);\n  border-color: var(--border-color, #d1d5db);\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\n  transform: translateY(-1px);\n}\n.icon-btn[data-v-2ca7b171]:active {\n  transform: translateY(0);\n  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);\n}\n.icon[data-v-2ca7b171] {\n  width: 18px;\n  height: 18px;\n}\n.icon-btn.delete[data-v-2ca7b171] {\n  color: #ef4444;\n}\n.icon-btn.delete[data-v-2ca7b171]:hover {\n  background: rgba(239, 68, 68, 0.1);\n  border-color: #ef4444;\n}\n",{});var M=(e,n)=>{const a=e.__vccOpts||e;for(const[e,t]of n)a[e]=t;return a};const U={class:"faq-card"},$={class:"faq-content"},P={class:"preview"},N={class:"faq-actions"};var V=M({__name:"FaqCard",props:{faq:{type:Object,required:!0}},emits:["delete"],setup:e=>(n,a)=>(o(),i("div",U,[l("div",$,[l("h4",null,s(e.faq.domanda),1),l("p",P,s(e.faq.risposta),1)]),l("div",N,[l("button",{type:"button",class:"icon-btn delete",title:"Elimina",onClick:a[0]||(a[0]=a=>n.$emit("delete",e.faq))},[d(c(F),{class:"icon"})])])]))},[["__scopeId","data-v-2ca7b171"]]);L("\n.overlay[data-v-6b27f6cb] {\n  position: fixed;\n  inset: 0;\n  background: rgba(0, 0, 0, 0.4);\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  z-index: 1000;\n}\n.modal[data-v-6b27f6cb] {\n  width: 640px;\n  max-width: 90vw;\n  background: #fff;\n  border-radius: 16px;\n  padding: 32px;\n}\ninput[data-v-6b27f6cb],\ntextarea[data-v-6b27f6cb] {\n  width: 100%;\n  margin-top: 12px;\n  padding: 12px;\n  border-radius: 10px;\n  border: 1px solid #ddd;\n  font: inherit;\n}\ntextarea[data-v-6b27f6cb] {\n  min-height: 180px;\n  resize: vertical;\n}\n.actions[data-v-6b27f6cb] {\n  display: flex;\n  justify-content: flex-end;\n  gap: 12px;\n  margin-top: 20px;\n}\n.save[data-v-6b27f6cb] {\n  background: #6c5ce7;\n  color: white;\n  border-radius: 10px;\n  border: 1px solid #6c5ce7;\n  padding: 10px 14px;\n}\n.save[data-v-6b27f6cb]:disabled {\n  opacity: 0.7;\n  cursor: not-allowed;\n}\n.cancel[data-v-6b27f6cb] {\n  background: transparent;\n  border-radius: 10px;\n  border: 1px solid #ddd;\n  padding: 10px 14px;\n}\n.error[data-v-6b27f6cb] {\n  color: #e54848;\n  margin-top: 8px;\n}\n",{});const Y={class:"modal"},B={key:0,class:"error"},Q={class:"actions"},W=["disabled"];var H=M({__name:"FaqModal",props:{faq:{type:Object,default:null}},emits:["close","saved"],setup(n,{emit:t}){const r=n,d=t,c=e(),g=R(),m=a(""),h=a(""),x=a(!1),y=a("");async function w(){if(y.value="",m.value.trim()&&h.value.trim()){x.value=!0;try{const e={domanda:m.value.trim(),risposta:h.value.trim()};!r.faq&&g.selectedAzienda?.value&&(e.azienda=g.selectedAzienda.value),r.faq?await c.patch(`/items/faq/${r.faq.id}`,e):await c.post("/items/faq",e),d("saved")}finally{x.value=!1}}else y.value="Domanda e risposta sono obbligatorie"}return u(()=>r.faq,e=>{m.value=e?.domanda??"",h.value=e?.risposta??""},{immediate:!0}),(e,a)=>(o(),i("div",{class:"overlay",onClick:a[3]||(a[3]=p(e=>d("close"),["self"]))},[l("div",Y,[l("h3",null,s(n.faq?"Modifica FAQ":"Nuova FAQ"),1),f(l("input",{"onUpdate:modelValue":a[0]||(a[0]=e=>m.value=e),placeholder:"Scrivi qui la domanda frequente",maxlength:"300"},null,512),[[b,m.value]]),f(l("textarea",{"onUpdate:modelValue":a[1]||(a[1]=e=>h.value=e),placeholder:"Scrivi qui la risposta",maxlength:"1200"},null,512),[[b,h.value]]),y.value?(o(),i("p",B,s(y.value),1)):v("v-if",!0),l("div",Q,[l("button",{class:"cancel",type:"button",onClick:a[2]||(a[2]=e=>d("close"))},"Annulla"),l("button",{class:"save",type:"button",onClick:w,disabled:x.value},s(x.value?"Salvataggio…":"Salva"),9,W)])])]))}},[["__scopeId","data-v-6b27f6cb"]]);L("\n.overlay[data-v-2a9f58ab] {\n  position: fixed;\n  inset: 0;\n  background: rgba(0, 0, 0, 0.45);\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  z-index: 1100;\n  padding: 24px;\n}\n.modal[data-v-2a9f58ab] {\n  width: 520px;\n  max-width: 90vw;\n  background: #fff;\n  border-radius: 16px;\n  padding: 24px;\n  border: 1px solid #eee;\n}\n.actions[data-v-2a9f58ab] {\n  display: flex;\n  justify-content: flex-end;\n  gap: 12px;\n  margin-top: 20px;\n}\n.cancel[data-v-2a9f58ab] {\n  background: transparent;\n  border-radius: 10px;\n  border: 1px solid #ddd;\n  padding: 10px 14px;\n  cursor: pointer;\n}\n.danger[data-v-2a9f58ab] {\n  background: #e74c3c;\n  color: white;\n  border-radius: 10px;\n  border: 1px solid #e74c3c;\n  padding: 10px 14px;\n  cursor: pointer;\n}\n.danger[data-v-2a9f58ab]:disabled {\n  opacity: 0.7;\n  cursor: not-allowed;\n}\n.error[data-v-2a9f58ab] {\n  color: #e54848;\n  margin-top: 8px;\n}\n",{});const K={class:"modal",role:"dialog","aria-modal":"true"},J={key:0,class:"error"},Z={class:"actions"},G=["disabled"];var X=M({__name:"ConfirmDeleteModal",props:{faq:{type:Object,required:!0},loading:{type:Boolean,default:!1},error:{type:String,default:""}},emits:["cancel","confirm"],setup:e=>(n,a)=>(o(),i("div",{class:"overlay",onClick:a[2]||(a[2]=p(e=>n.$emit("cancel"),["self"]))},[l("div",K,[a[3]||(a[3]=l("h3",null,"Stai per cancellare una FAQ",-1)),l("p",null,[l("strong",null,s(e.faq?.domanda),1)]),e.error?(o(),i("p",J,s(e.error),1)):v("v-if",!0),l("div",Z,[l("button",{type:"button",class:"cancel",onClick:a[0]||(a[0]=e=>n.$emit("cancel"))},"Annulla"),l("button",{type:"button",class:"danger",disabled:e.loading,onClick:a[1]||(a[1]=e=>n.$emit("confirm"))},s(e.loading?"Eliminazione…":"Elimina"),9,G)])])]))},[["__scopeId","data-v-2a9f58ab"]]);function ee(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var ne,ae={exports:{}};
/* @license
Papa Parse
v5.5.3
https://github.com/mholt/PapaParse
License: MIT
*/var te=(ne||(ne=1,ae.exports=function e(){var n,a="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==a?a:{},t=!a.document&&!!a.postMessage,r=a.IS_PAPA_WORKER||!1,i={},o=0,l={};function s(e){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},function(e){var n=x(e);n.chunkSize=parseInt(n.chunkSize),e.step||e.chunk||(n.chunkSize=null),this._handle=new f(n),(this._handle.streamer=this)._config=n}.call(this,e),this.parseChunk=function(e,n){var t=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<t){let n=this._config.newline;n||(i=this._config.quoteChar||'"',n=this._handle.guessLineEndings(e,i)),e=[...e.split(n).slice(t)].join(n)}this.isFirstChunk&&w(this._config.beforeFirstChunk)&&void 0!==(i=this._config.beforeFirstChunk(e))&&(e=i),this.isFirstChunk=!1,this._halted=!1,t=this._partialLine+e;var i=(this._partialLine="",this._handle.parse(t,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(e=i.meta.cursor,this._finished||(this._partialLine=t.substring(e-this._baseIndex),this._baseIndex=e),i&&i.data&&(this._rowCount+=i.data.length),t=this._finished||this._config.preview&&this._rowCount>=this._config.preview,r)a.postMessage({results:i,workerId:l.WORKER_ID,finished:t});else if(w(this._config.chunk)&&!n){if(this._config.chunk(i,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=i=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(i.data),this._completeResults.errors=this._completeResults.errors.concat(i.errors),this._completeResults.meta=i.meta),this._completed||!t||!w(this._config.complete)||i&&i.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),t||i&&i.meta.paused||this._nextChunk(),i}this._halted=!0},this._sendError=function(e){w(this._config.error)?this._config.error(e):r&&this._config.error&&a.postMessage({workerId:l.WORKER_ID,error:e,finished:!1})}}function d(e){var n;(e=e||{}).chunkSize||(e.chunkSize=l.RemoteChunkSize),s.call(this,e),this._nextChunk=t?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(e){this._input=e,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(n=new XMLHttpRequest,this._config.withCredentials&&(n.withCredentials=this._config.withCredentials),t||(n.onload=y(this._chunkLoaded,this),n.onerror=y(this._chunkError,this)),n.open(this._config.downloadRequestBody?"POST":"GET",this._input,!t),this._config.downloadRequestHeaders){var e,a=this._config.downloadRequestHeaders;for(e in a)n.setRequestHeader(e,a[e])}var r;this._config.chunkSize&&(r=this._start+this._config.chunkSize-1,n.setRequestHeader("Range","bytes="+this._start+"-"+r));try{n.send(this._config.downloadRequestBody)}catch(e){this._chunkError(e.message)}t&&0===n.status&&this._chunkError()}},this._chunkLoaded=function(){4===n.readyState&&(n.status<200||400<=n.status?this._chunkError():(this._start+=this._config.chunkSize||n.responseText.length,this._finished=!this._config.chunkSize||this._start>=(e=>null!==(e=e.getResponseHeader("Content-Range"))?parseInt(e.substring(e.lastIndexOf("/")+1)):-1)(n),this.parseChunk(n.responseText)))},this._chunkError=function(e){e=n.statusText||e,this._sendError(new Error(e))}}function c(e){(e=e||{}).chunkSize||(e.chunkSize=l.LocalChunkSize),s.call(this,e);var n,a,t="undefined"!=typeof FileReader;this.stream=function(e){this._input=e,a=e.slice||e.webkitSlice||e.mozSlice,t?((n=new FileReader).onload=y(this._chunkLoaded,this),n.onerror=y(this._chunkError,this)):n=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var e=this._input,r=(this._config.chunkSize&&(r=Math.min(this._start+this._config.chunkSize,this._input.size),e=a.call(e,this._start,r)),n.readAsText(e,this._config.encoding));t||this._chunkLoaded({target:{result:r}})},this._chunkLoaded=function(e){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(e.target.result)},this._chunkError=function(){this._sendError(n.error)}}function u(e){var n;s.call(this,e=e||{}),this.stream=function(e){return n=e,this._nextChunk()},this._nextChunk=function(){var e,a;if(!this._finished)return e=this._config.chunkSize,n=e?(a=n.substring(0,e),n.substring(e)):(a=n,""),this._finished=!n,this.parseChunk(a)}}function p(e){s.call(this,e=e||{});var n=[],a=!0,t=!1;this.pause=function(){s.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){s.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(e){this._input=e,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){t&&1===n.length&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),n.length?this.parseChunk(n.shift()):a=!0},this._streamData=y(function(e){try{n.push("string"==typeof e?e:e.toString(this._config.encoding)),a&&(a=!1,this._checkIsFinished(),this.parseChunk(n.shift()))}catch(e){this._streamError(e)}},this),this._streamError=y(function(e){this._streamCleanUp(),this._sendError(e)},this),this._streamEnd=y(function(){this._streamCleanUp(),t=!0,this._streamData("")},this),this._streamCleanUp=y(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function f(e){var n,a,t,r,i=Math.pow(2,53),o=-i,s=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,d=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,c=this,u=0,p=0,f=!1,g=!1,m=[],h={data:[],errors:[],meta:{}};function y(n){return"greedy"===e.skipEmptyLines?""===n.join("").trim():1===n.length&&0===n[0].length}function k(){if(h&&t&&(z("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+l.DefaultDelimiter+"'"),t=!1),e.skipEmptyLines&&(h.data=h.data.filter(function(e){return!y(e)})),_()){if(h)if(Array.isArray(h.data[0])){for(var n=0;_()&&n<h.data.length;n++)h.data[n].forEach(c);h.data.splice(0,1)}else h.data.forEach(c);function c(n,a){w(e.transformHeader)&&(n=e.transformHeader(n,a)),m.push(n)}}function a(n,a){for(var t=e.header?{}:[],r=0;r<n.length;r++){var l=r,c=n[r];c=((n,a)=>(n=>(e.dynamicTypingFunction&&void 0===e.dynamicTyping[n]&&(e.dynamicTyping[n]=e.dynamicTypingFunction(n)),!0===(e.dynamicTyping[n]||e.dynamicTyping)))(n)?"true"===a||"TRUE"===a||"false"!==a&&"FALSE"!==a&&((e=>{if(s.test(e)&&(e=parseFloat(e),o<e&&e<i))return 1})(a)?parseFloat(a):d.test(a)?new Date(a):""===a?null:a):a)(l=e.header?r>=m.length?"__parsed_extra":m[r]:l,c=e.transform?e.transform(c,l):c),"__parsed_extra"===l?(t[l]=t[l]||[],t[l].push(c)):t[l]=c}return e.header&&(r>m.length?z("FieldMismatch","TooManyFields","Too many fields: expected "+m.length+" fields but parsed "+r,p+a):r<m.length&&z("FieldMismatch","TooFewFields","Too few fields: expected "+m.length+" fields but parsed "+r,p+a)),t}var r;h&&(e.header||e.dynamicTyping||e.transform)&&(r=1,!h.data.length||Array.isArray(h.data[0])?(h.data=h.data.map(a),r=h.data.length):h.data=a(h.data,0),e.header&&h.meta&&(h.meta.fields=m),p+=r)}function _(){return e.header&&0===m.length}function z(e,n,a,t){e={type:e,code:n,message:a},void 0!==t&&(e.row=t),h.errors.push(e)}w(e.step)&&(r=e.step,e.step=function(n){h=n,_()?k():(k(),0!==h.data.length&&(u+=n.data.length,e.preview&&u>e.preview?a.abort():(h.data=h.data[0],r(h,c))))}),this.parse=function(r,i,o){var s=e.quoteChar||'"';return e.newline||(e.newline=this.guessLineEndings(r,s)),t=!1,e.delimiter?w(e.delimiter)&&(e.delimiter=e.delimiter(r),h.meta.delimiter=e.delimiter):((s=((n,a,t,r,i)=>{var o,s,d,c;i=i||[",","\t","|",";",l.RECORD_SEP,l.UNIT_SEP];for(var u=0;u<i.length;u++){for(var p,f=i[u],v=0,g=0,m=0,h=(d=void 0,new b({comments:r,delimiter:f,newline:a,preview:10}).parse(n)),x=0;x<h.data.length;x++)t&&y(h.data[x])?m++:(g+=p=h.data[x].length,void 0===d?d=p:0<p&&(v+=Math.abs(p-d),d=p));0<h.data.length&&(g/=h.data.length-m),(void 0===s||v<=s)&&(void 0===c||c<g)&&1.99<g&&(s=v,o=f,c=g)}return{successful:!!(e.delimiter=o),bestDelimiter:o}})(r,e.newline,e.skipEmptyLines,e.comments,e.delimitersToGuess)).successful?e.delimiter=s.bestDelimiter:(t=!0,e.delimiter=l.DefaultDelimiter),h.meta.delimiter=e.delimiter),s=x(e),e.preview&&e.header&&s.preview++,n=r,a=new b(s),h=a.parse(n,i,o),k(),f?{meta:{paused:!0}}:h||{meta:{paused:!1}}},this.paused=function(){return f},this.pause=function(){f=!0,a.abort(),n=w(e.chunk)?"":n.substring(a.getCharIndex())},this.resume=function(){c.streamer._halted?(f=!1,c.streamer.parseChunk(n,!0)):setTimeout(c.resume,3)},this.aborted=function(){return g},this.abort=function(){g=!0,a.abort(),h.meta.aborted=!0,w(e.complete)&&e.complete(h),n=""},this.guessLineEndings=function(e,n){e=e.substring(0,1048576),n=new RegExp(v(n)+"([^]*?)"+v(n),"gm");var a=(e=e.replace(n,"")).split("\r");if(e=1<(n=e.split("\n")).length&&n[0].length<a[0].length,1===a.length||e)return"\n";for(var t=0,r=0;r<a.length;r++)"\n"===a[r][0]&&t++;return t>=a.length/2?"\r\n":"\r"}}function v(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function b(e){var n=(e=e||{}).delimiter,a=e.newline,t=e.comments,r=e.step,i=e.preview,o=e.fastMode,s=null,d=!1,c=null==e.quoteChar?'"':e.quoteChar,u=c;if(void 0!==e.escapeChar&&(u=e.escapeChar),("string"!=typeof n||-1<l.BAD_DELIMITERS.indexOf(n))&&(n=","),t===n)throw new Error("Comment character same as delimiter");!0===t?t="#":("string"!=typeof t||-1<l.BAD_DELIMITERS.indexOf(t))&&(t=!1),"\n"!==a&&"\r"!==a&&"\r\n"!==a&&(a="\n");var p=0,f=!1;this.parse=function(l,b,g){if("string"!=typeof l)throw new Error("Input must be a string");var m=l.length,h=n.length,x=a.length,y=t.length,k=w(r),_=[],z=[],C=[],E=p=0;if(!l)return M();if(o||!1!==o&&-1===l.indexOf(c)){for(var S=l.split(a),A=0;A<S.length;A++){if(C=S[A],p+=C.length,A!==S.length-1)p+=a.length;else if(g)return M();if(!t||C.substring(0,y)!==t){if(k){if(_=[],F(C.split(n)),U(),f)return M()}else F(C.split(n));if(i&&i<=A)return _=_.slice(0,i),M(!0)}}return M()}for(var I=l.indexOf(n,p),q=l.indexOf(a,p),R=new RegExp(v(u)+v(c),"g"),O=l.indexOf(c,p);;)if(l[p]===c)for(O=p,p++;;){if(-1===(O=l.indexOf(c,O+1)))return g||z.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:_.length,index:p}),D();if(O===m-1)return D(l.substring(p,O).replace(R,c));if(c===u&&l[O+1]===u)O++;else if(c===u||0===O||l[O-1]!==u){-1!==I&&I<O+1&&(I=l.indexOf(n,O+1));var j=T(-1===(q=-1!==q&&q<O+1?l.indexOf(a,O+1):q)?I:Math.min(I,q));if(l.substr(O+1+j,h)===n){C.push(l.substring(p,O).replace(R,c)),l[p=O+1+j+h]!==c&&(O=l.indexOf(c,p)),I=l.indexOf(n,p),q=l.indexOf(a,p);break}if(j=T(q),l.substring(O+1+j,O+1+j+x)===a){if(C.push(l.substring(p,O).replace(R,c)),L(O+1+j+x),I=l.indexOf(n,p),O=l.indexOf(c,p),k&&(U(),f))return M();if(i&&_.length>=i)return M(!0);break}z.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:_.length,index:p}),O++}}else if(t&&0===C.length&&l.substring(p,p+y)===t){if(-1===q)return M();p=q+x,q=l.indexOf(a,p),I=l.indexOf(n,p)}else if(-1!==I&&(I<q||-1===q))C.push(l.substring(p,I)),p=I+h,I=l.indexOf(n,p);else{if(-1===q)break;if(C.push(l.substring(p,q)),L(q+x),k&&(U(),f))return M();if(i&&_.length>=i)return M(!0)}return D();function F(e){_.push(e),E=p}function T(e){var n=0;return-1!==e&&(e=l.substring(O+1,e))&&""===e.trim()?e.length:n}function D(e){return g||(void 0===e&&(e=l.substring(p)),C.push(e),p=m,F(C),k&&U()),M()}function L(e){p=e,F(C),C=[],q=l.indexOf(a,p)}function M(t){if(e.header&&!b&&_.length&&!d){var r=_[0],i=Object.create(null),o=new Set(r);let n=!1;for(let a=0;a<r.length;a++){let t=r[a];if(i[t=w(e.transformHeader)?e.transformHeader(t,a):t]){let e,l=i[t];for(;e=t+"_"+l,l++,o.has(e););o.add(e),r[a]=e,i[t]++,n=!0,(s=null===s?{}:s)[e]=t}else i[t]=1,r[a]=t;o.add(t)}n&&console.warn("Duplicate headers found and renamed."),d=!0}return{data:_,errors:z,meta:{delimiter:n,linebreak:a,aborted:f,truncated:!!t,cursor:E+(b||0),renamedHeaders:s}}}function U(){r(M()),_=[],z=[]}},this.abort=function(){f=!0},this.getCharIndex=function(){return p}}function g(e){var n=e.data,a=i[n.workerId],t=!1;if(n.error)a.userError(n.error,n.file);else if(n.results&&n.results.data){var r={abort:function(){t=!0,m(n.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:h,resume:h};if(w(a.userStep)){for(var o=0;o<n.results.data.length&&(a.userStep({data:n.results.data[o],errors:n.results.errors,meta:n.results.meta},r),!t);o++);delete n.results}else w(a.userChunk)&&(a.userChunk(n.results,r,n.file),delete n.results)}n.finished&&!t&&m(n.workerId,n.results)}function m(e,n){var a=i[e];w(a.userComplete)&&a.userComplete(n),a.terminate(),delete i[e]}function h(){throw new Error("Not implemented.")}function x(e){if("object"!=typeof e||null===e)return e;var n,a=Array.isArray(e)?[]:{};for(n in e)a[n]=x(e[n]);return a}function y(e,n){return function(){e.apply(n,arguments)}}function w(e){return"function"==typeof e}return l.parse=function(n,t){var r=(t=t||{}).dynamicTyping||!1;if(w(r)&&(t.dynamicTypingFunction=r,r={}),t.dynamicTyping=r,t.transform=!!w(t.transform)&&t.transform,!t.worker||!l.WORKERS_SUPPORTED)return r=null,l.NODE_STREAM_INPUT,"string"==typeof n?(n=(e=>65279!==e.charCodeAt(0)?e:e.slice(1))(n),r=new(t.download?d:u)(t)):!0===n.readable&&w(n.read)&&w(n.on)?r=new p(t):(a.File&&n instanceof File||n instanceof Object)&&(r=new c(t)),r.stream(n);(r=(()=>{var n;return!!l.WORKERS_SUPPORTED&&(n=(()=>{var n=a.URL||a.webkitURL||null,t=e.toString();return l.BLOB_URL||(l.BLOB_URL=n.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",t,")();"],{type:"text/javascript"})))})(),(n=new a.Worker(n)).onmessage=g,n.id=o++,i[n.id]=n)})()).userStep=t.step,r.userChunk=t.chunk,r.userComplete=t.complete,r.userError=t.error,t.step=w(t.step),t.chunk=w(t.chunk),t.complete=w(t.complete),t.error=w(t.error),delete t.worker,r.postMessage({input:n,config:t,workerId:r.id})},l.unparse=function(e,n){var a=!1,t=!0,r=",",i="\r\n",o='"',s=o+o,d=!1,c=null,u=!1,p=((()=>{if("object"==typeof n){if("string"!=typeof n.delimiter||l.BAD_DELIMITERS.filter(function(e){return-1!==n.delimiter.indexOf(e)}).length||(r=n.delimiter),"boolean"!=typeof n.quotes&&"function"!=typeof n.quotes&&!Array.isArray(n.quotes)||(a=n.quotes),"boolean"!=typeof n.skipEmptyLines&&"string"!=typeof n.skipEmptyLines||(d=n.skipEmptyLines),"string"==typeof n.newline&&(i=n.newline),"string"==typeof n.quoteChar&&(o=n.quoteChar),"boolean"==typeof n.header&&(t=n.header),Array.isArray(n.columns)){if(0===n.columns.length)throw new Error("Option columns is empty");c=n.columns}void 0!==n.escapeChar&&(s=n.escapeChar+o),n.escapeFormulae instanceof RegExp?u=n.escapeFormulae:"boolean"==typeof n.escapeFormulae&&n.escapeFormulae&&(u=/^[=+\-@\t\r].*$/)}})(),new RegExp(v(o),"g"));if("string"==typeof e&&(e=JSON.parse(e)),Array.isArray(e)){if(!e.length||Array.isArray(e[0]))return f(null,e,d);if("object"==typeof e[0])return f(c||Object.keys(e[0]),e,d)}else if("object"==typeof e)return"string"==typeof e.data&&(e.data=JSON.parse(e.data)),Array.isArray(e.data)&&(e.fields||(e.fields=e.meta&&e.meta.fields||c),e.fields||(e.fields=Array.isArray(e.data[0])?e.fields:"object"==typeof e.data[0]?Object.keys(e.data[0]):[]),Array.isArray(e.data[0])||"object"==typeof e.data[0]||(e.data=[e.data])),f(e.fields||[],e.data||[],d);throw new Error("Unable to serialize unrecognized input");function f(e,n,a){var o="",l=("string"==typeof e&&(e=JSON.parse(e)),"string"==typeof n&&(n=JSON.parse(n)),Array.isArray(e)&&0<e.length),s=!Array.isArray(n[0]);if(l&&t){for(var d=0;d<e.length;d++)0<d&&(o+=r),o+=b(e[d],d);0<n.length&&(o+=i)}for(var c=0;c<n.length;c++){var u=(l?e:n[c]).length,p=!1,f=l?0===Object.keys(n[c]).length:0===n[c].length;if(a&&!l&&(p="greedy"===a?""===n[c].join("").trim():1===n[c].length&&0===n[c][0].length),"greedy"===a&&l){for(var v=[],g=0;g<u;g++){var m=s?e[g]:g;v.push(n[c][m])}p=""===v.join("").trim()}if(!p){for(var h=0;h<u;h++){0<h&&!f&&(o+=r);var x=l&&s?e[h]:h;o+=b(n[c][x],h)}c<n.length-1&&(!a||0<u&&!f)&&(o+=i)}}return o}function b(e,n){var t,i;return null==e?"":e.constructor===Date?JSON.stringify(e).slice(1,25):(i=!1,u&&"string"==typeof e&&u.test(e)&&(e="'"+e,i=!0),t=e.toString().replace(p,s),(i=i||!0===a||"function"==typeof a&&a(e,n)||Array.isArray(a)&&a[n]||((e,n)=>{for(var a=0;a<n.length;a++)if(-1<e.indexOf(n[a]))return!0;return!1})(t,l.BAD_DELIMITERS)||-1<t.indexOf(r)||" "===t.charAt(0)||" "===t.charAt(t.length-1))?o+t+o:t)}},l.RECORD_SEP=String.fromCharCode(30),l.UNIT_SEP=String.fromCharCode(31),l.BYTE_ORDER_MARK="\ufeff",l.BAD_DELIMITERS=["\r","\n",'"',l.BYTE_ORDER_MARK],l.WORKERS_SUPPORTED=!t&&!!a.Worker,l.NODE_STREAM_INPUT=1,l.LocalChunkSize=10485760,l.RemoteChunkSize=5242880,l.DefaultDelimiter=",",l.Parser=b,l.ParserHandle=f,l.NetworkStreamer=d,l.FileStreamer=c,l.StringStreamer=u,l.ReadableStreamStreamer=p,a.jQuery&&((n=a.jQuery).fn.parse=function(e){var t=e.config||{},r=[];return this.each(function(e){if("INPUT"!==n(this).prop("tagName").toUpperCase()||"file"!==n(this).attr("type").toLowerCase()||!a.FileReader||!this.files||0===this.files.length)return!0;for(var i=0;i<this.files.length;i++)r.push({file:this.files[i],inputElem:this,instanceConfig:n.extend({},t)})}),i(),this;function i(){if(0===r.length)w(e.complete)&&e.complete();else{var a,t,i,s,d=r[0];if(w(e.before)){var c=e.before(d.file,d.inputElem);if("object"==typeof c){if("abort"===c.action)return a="AbortError",t=d.file,i=d.inputElem,s=c.reason,void(w(e.error)&&e.error({name:a},t,i,s));if("skip"===c.action)return void o();"object"==typeof c.config&&(d.instanceConfig=n.extend(d.instanceConfig,c.config))}else if("skip"===c)return void o()}var u=d.instanceConfig.complete;d.instanceConfig.complete=function(e){w(u)&&u(e,d.file,d.inputElem),o()},l.parse(d.file,d.instanceConfig)}}function o(){r.splice(0,1),i()}}),r&&(a.onmessage=function(e){e=e.data,void 0===l.WORKER_ID&&e&&(l.WORKER_ID=e.workerId),"string"==typeof e.input?a.postMessage({workerId:l.WORKER_ID,results:l.parse(e.input,e.config),finished:!0}):(a.File&&e.input instanceof File||e.input instanceof Object)&&(e=l.parse(e.input,e.config))&&a.postMessage({workerId:l.WORKER_ID,results:e,finished:!0})}),(d.prototype=Object.create(s.prototype)).constructor=d,(c.prototype=Object.create(s.prototype)).constructor=c,(u.prototype=Object.create(u.prototype)).constructor=u,(p.prototype=Object.create(s.prototype)).constructor=p,l}()),ae.exports),re=ee(te);L("\n.overlay[data-v-0243740b] {\n  position: fixed;\n  inset: 0;\n  background: rgba(0, 0, 0, 0.4);\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  z-index: 1200;\n  padding: 24px;\n}\n.modal[data-v-0243740b] {\n  width: 720px;\n  max-width: 95vw;\n  background: #fff;\n  border-radius: 16px;\n  padding: 24px;\n  border: 1px solid #eee;\n}\n.modal-header[data-v-0243740b] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  gap: 16px;\n  margin-bottom: 12px;\n}\n.close[data-v-0243740b] {\n  width: 36px;\n  height: 36px;\n  border-radius: 10px;\n  border: 1px solid #e5e5e5;\n  background: #fff;\n  cursor: pointer;\n}\n.csv-requirements[data-v-0243740b] {\n  background: #f3f0ff;\n  color: #6c5cff;\n  border-radius: 12px;\n  padding: 16px;\n  margin-bottom: 16px;\n}\n.requirements-header[data-v-0243740b] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  gap: 12px;\n  margin-bottom: 8px;\n}\n.csv-requirements a[data-v-0243740b] {\n  font-weight: 600;\n  text-decoration: underline;\n  cursor: pointer;\n  color: inherit;\n}\ninput[type='file'][data-v-0243740b] {\n  margin-top: 8px;\n}\n.errors[data-v-0243740b] {\n  color: #e54848;\n  margin-top: 12px;\n}\n.progress[data-v-0243740b] {\n  margin-top: 12px;\n  display: flex;\n  align-items: center;\n  gap: 8px;\n}\n.progress progress[data-v-0243740b] {\n  width: 100%;\n}\n.actions[data-v-0243740b] {\n  display: flex;\n  justify-content: flex-end;\n  gap: 12px;\n  margin-top: 20px;\n}\n.btn-primary[data-v-0243740b] {\n  background: #6c5ce7;\n  color: white;\n  border-radius: 10px;\n  border: 1px solid #6c5ce7;\n  padding: 10px 14px;\n  cursor: pointer;\n}\n.btn-primary[data-v-0243740b]:disabled {\n  opacity: 0.7;\n  cursor: not-allowed;\n}\n.btn-secondary[data-v-0243740b] {\n  background: transparent;\n  border-radius: 10px;\n  border: 1px solid #ddd;\n  padding: 10px 14px;\n  cursor: pointer;\n}\n",{});const ie={class:"modal"},oe={class:"modal-header"},le={class:"csv-requirements"},se={class:"requirements-header"},de={key:0,class:"errors"},ce={key:1,class:"progress"},ue=["value"],pe={class:"actions"},fe=["disabled"],ve={__name:"ImportFaqModal",emits:["close","imported"],setup(n,{emit:t}){const r=t,d=e(),c=R(),u=a(null),f=a(""),b=a(0),g=a(!1),m=a(!1);function h(e){u.value=e?.target?.files?.[0]??null,f.value="",b.value=0}async function x(){if(u.value){m.value=!0;try{b.value=10,g.value=!0,await async function(e,n,a=null){return new Promise((t,r)=>{re.parse(n,{header:!0,delimiter:"",skipEmptyLines:!0,encoding:"UTF-8",dynamicTyping:!1,complete:async n=>{try{if(!n.data?.length)throw new Error("CSV vuoto o non valido");let r=n.data.map(e=>{const n={};return Object.entries(e).forEach(([e,a])=>{if(!e)return;const t=String(e).replace(/^\uFEFF/,"").trim().toLowerCase();n[t]="string"==typeof a?a.trim():String(a??"").trim()}),n}).filter(e=>e.domanda&&e.risposta);if(!r.length)throw new Error("CSV valido ma senza righe importabili");a?.selectedAzienda?.value&&(r=r.map(e=>({...e,azienda:a.selectedAzienda.value}))),await e.post("/items/faq",r),t(r.length)}catch(e){r(e)}},error:e=>r(e)})})}(d,u.value,c),b.value=100,r("imported"),r("close")}catch(e){f.value=e?.message||"Errore durante import CSV."}finally{g.value=!1,m.value=!1}}}function y(){const e=new Blob(["domanda;risposta\nEsempio domanda;Esempio risposta"],{type:"text/csv;charset=utf-8;"}),n=URL.createObjectURL(e),a=document.createElement("a");a.href=n,a.download="faq_example.csv",a.click(),URL.revokeObjectURL(n)}return(e,n)=>(o(),i("div",{class:"overlay",onClick:n[2]||(n[2]=p(e=>r("close"),["self"]))},[l("div",ie,[l("div",oe,[n[3]||(n[3]=l("h2",null,"Importa le tue FAQ da CSV",-1)),l("button",{class:"close",type:"button",onClick:n[0]||(n[0]=e=>r("close"))},"✕")]),l("div",le,[l("div",se,[n[4]||(n[4]=l("h3",null,"Requisiti per importare con file CSV",-1)),l("a",{href:"#",onClick:p(y,["prevent"])},"Scarica esempio")]),n[5]||(n[5]=l("ul",null,[l("li",null,"prima colonna: domanda"),l("li",null,"seconda colonna: risposta"),l("li",null,"usa il punto e virgola (;) come separatore (consigliato)"),l("li",null,"massimo 100 FAQ per importazione"),l("li",null,"lunghezza massima domanda: 300 caratteri"),l("li",null,"lunghezza massima risposta: 1200 caratteri")],-1))]),n[6]||(n[6]=l("h4",null,"Seleziona il tuo file CSV",-1)),l("input",{type:"file",accept:".csv",onChange:h},null,32),f.value?(o(),i("div",de,"⚠ "+s(f.value),1)):v("v-if",!0),b.value>0?(o(),i("div",ce,[l("progress",{value:b.value,max:"100"},null,8,ue),l("span",null,s(b.value)+"%",1)])):v("v-if",!0),l("div",pe,[l("button",{type:"button",class:"btn-secondary",onClick:n[1]||(n[1]=e=>r("close"))},"Annulla"),l("button",{type:"button",class:"btn-primary",disabled:!u.value||g.value||m.value,onClick:x},s(m.value?"Importazione…":"Importa FAQ"),9,fe)])])]))}};var be=M(ve,[["__scopeId","data-v-0243740b"]]);L("\n.faq-tab[data-v-5715189b] {\n  display: grid;\n  gap: 20px;\n}\n.faq-header[data-v-5715189b] {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  gap: 16px;\n  margin-bottom: 32px;\n  padding-bottom: 24px;\n  border-bottom: 1px solid var(--border-normal, #e8e8e8);\n  flex-wrap: wrap;\n}\n.faq-search[data-v-5715189b] {\n  width: 360px;\n  height: 44px;\n  padding: 0 16px;\n  border-radius: 10px;\n  border: 1px solid var(--border-color-subdued, #e5e7eb);\n  font: inherit;\n  font-size: 14px;\n  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n  background: var(--background, #ffffff);\n  color: var(--foreground, #1a1a1a);\n}\n.faq-search[data-v-5715189b]:focus {\n  outline: none;\n  border-color: var(--primary, #5e72e4);\n  box-shadow: 0 0 0 3px rgba(94, 114, 228, 0.1);\n}\n.faq-actions[data-v-5715189b] {\n  display: flex;\n  gap: 12px;\n}\n.btn-primary[data-v-5715189b] {\n  height: 44px;\n  background: linear-gradient(135deg, #5e72e4 0%, #7c8de8 100%);\n  color: white;\n  border-radius: 10px;\n  border: 1px solid #5e72e4;\n  padding: 0 20px;\n  cursor: pointer;\n  white-space: nowrap;\n  font-size: 14px;\n  font-weight: 600;\n  letter-spacing: -0.01em;\n  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n  box-shadow: 0 1px 2px rgba(94, 114, 228, 0.2), 0 1px 3px rgba(94, 114, 228, 0.1);\n}\n.btn-primary[data-v-5715189b]:hover {\n  box-shadow: 0 4px 6px rgba(94, 114, 228, 0.25), 0 2px 4px rgba(94, 114, 228, 0.15);\n  transform: translateY(-1px);\n}\n.btn-primary[data-v-5715189b]:active {\n  transform: translateY(0);\n  box-shadow: 0 1px 2px rgba(94, 114, 228, 0.2);\n}\n.btn-secondary[data-v-5715189b] {\n  height: 44px;\n  background: var(--background, #ffffff);\n  color: var(--foreground, #1a1a1a);\n  border-radius: 10px;\n  border: 1px solid var(--border-color-subdued, #e5e7eb);\n  padding: 0 20px;\n  cursor: pointer;\n  font-size: 14px;\n  font-weight: 600;\n  letter-spacing: -0.01em;\n  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05), 0 1px 3px rgba(0, 0, 0, 0.1);\n}\n.btn-secondary[data-v-5715189b]:hover {\n  background: var(--background-subdued, #f9fafb);\n  border-color: var(--border-color, #d1d5db);\n  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.07), 0 2px 4px rgba(0, 0, 0, 0.06);\n  transform: translateY(-1px);\n}\n.btn-secondary[data-v-5715189b]:active {\n  transform: translateY(0);\n  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);\n}\n.error[data-v-5715189b] {\n  color: #ef4444;\n  font-size: 14px;\n  font-weight: 500;\n  padding: 12px 16px;\n  background: rgba(239, 68, 68, 0.1);\n  border-radius: 8px;\n  border: 1px solid rgba(239, 68, 68, 0.2);\n}\n",{});const ge={class:"faq-tab"},me={class:"faq-header"},he={key:0,class:"error"};var xe=M({__name:"FaqTab",setup(n){const t=e(),r=R(),d=a([]),c=a(!1),p=a(!1),w=a(""),k=a(""),_=a(""),z=a(null),C=a(!1),E=g(()=>d.value.filter(e=>{const n=w.value.toLowerCase();return String(e.domanda||"").toLowerCase().includes(n)||String(e.risposta||"").toLowerCase().includes(n)}));async function S(){c.value=!1,p.value=!1,k.value="";let e=[];const n={fields:["id","domanda","risposta","azienda"],sort:["-id"],limit:100};r.selectedAzienda?.value&&(n.filter={azienda:{_eq:r.selectedAzienda.value}});try{const a=await t.get("/items/faq",{params:n});e=a?.data?.data??[]}catch(a){try{const a=await t.get("/items/faq",{params:n});e=a?.data?.data??[]}catch(e){return d.value=[],void(k.value="Errore caricamento FAQ")}}d.value=e}function A(){c.value=!0}function I(){p.value=!0}async function q(){p.value=!1,await S()}function O(e){_.value="",z.value=e}async function j(){if(z.value&&!C.value){C.value=!0;try{const e=z.value.id;let n=!1;const a=[()=>t.patch(`/items/faq/${e}`,{delete:!0}),()=>t.patch("/items/faq",{keys:[e],data:{delete:!0}}),()=>t.patch("/items/faq",{data:{delete:!0}},{params:{"filter[id][_eq]":e}})];for(const e of a)try{await e(),n=!0;break}catch(e){}if(!n)throw new Error("update_failed");_.value="",z.value=null,await S()}catch(e){_.value="Errore durante eliminazione FAQ"}finally{C.value=!1}}}return m(()=>{S()}),u(()=>r.selectedAzienda?.value,()=>{S()},{immediate:!1}),(e,n)=>(o(),i("div",ge,[l("div",me,[f(l("input",{"onUpdate:modelValue":n[0]||(n[0]=e=>w.value=e),class:"faq-search",placeholder:"Cerca FAQ…"},null,512),[[b,w.value]]),l("div",{class:"faq-actions"},[l("button",{class:"btn-secondary",type:"button",onClick:I}," Importa CSV "),l("button",{class:"btn-primary",type:"button",onClick:A}," + Aggiungi FAQ ")])]),k.value?(o(),i("p",he,s(k.value),1)):v("v-if",!0),(o(!0),i(x,null,y(E.value,e=>(o(),h(V,{key:e.id,faq:e,onDelete:O},null,8,["faq"]))),128)),c.value?(o(),h(H,{key:1,faq:null,onClose:n[1]||(n[1]=e=>c.value=!1),onSaved:S})):v("v-if",!0),z.value?(o(),h(X,{key:2,faq:z.value,loading:C.value,error:_.value,onCancel:n[2]||(n[2]=e=>z.value=null),onConfirm:j},null,8,["faq","loading","error"])):v("v-if",!0),p.value?(o(),h(be,{key:3,onClose:n[3]||(n[3]=e=>p.value=!1),onImported:q})):v("v-if",!0)]))}},[["__scopeId","data-v-5715189b"]]);L("\n.file-tab[data-v-83b710e3] {\n  display: grid;\n  gap: 20px;\n}\n.file-header[data-v-83b710e3] {\n  display: flex;\n  justify-content: flex-start;\n  align-items: center;\n  gap: 16px;\n  margin-bottom: 32px;\n  padding-bottom: 24px;\n  border-bottom: 1px solid var(--border-normal, #e8e8e8);\n}\n.file-search[data-v-83b710e3] {\n  width: 360px;\n  height: 44px;\n  padding: 0 16px;\n  border-radius: 10px;\n  border: 1px solid var(--border-color-subdued, #e5e7eb);\n  font: inherit;\n  font-size: 14px;\n  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n  background: var(--background, #ffffff);\n  color: var(--foreground, #1a1a1a);\n}\n.file-search[data-v-83b710e3]:focus {\n  outline: none;\n  border-color: var(--primary, #5e72e4);\n  box-shadow: 0 0 0 3px rgba(94, 114, 228, 0.1);\n}\n.file-upload[data-v-83b710e3] {\n  width: 100%;\n  min-height: 140px;\n  background: linear-gradient(135deg, rgba(94, 114, 228, 0.08) 0%, rgba(124, 141, 232, 0.05) 100%);\n  border: 2px dashed #5e72e4;\n  border-radius: 12px;\n  color: #5e72e4;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  text-align: center;\n  cursor: pointer;\n  padding: 32px 20px;\n  margin-bottom: 24px;\n  position: relative;\n  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n  box-shadow: 0 2px 4px rgba(94, 114, 228, 0.1);\n}\n.file-upload[data-v-83b710e3]:hover {\n  background: linear-gradient(135deg, rgba(94, 114, 228, 0.12) 0%, rgba(124, 141, 232, 0.08) 100%);\n  border-color: #4c63d2;\n  box-shadow: 0 4px 8px rgba(94, 114, 228, 0.15);\n  transform: translateY(-1px);\n}\n.file-upload.is-dragging[data-v-83b710e3] {\n  background: linear-gradient(135deg, rgba(94, 114, 228, 0.15) 0%, rgba(124, 141, 232, 0.12) 100%);\n  border-color: #4c63d2;\n  box-shadow: 0 6px 12px rgba(94, 114, 228, 0.2);\n}\n.file-upload.is-uploading[data-v-83b710e3] {\n  cursor: default;\n  opacity: 0.85;\n}\n.file-input[data-v-83b710e3] {\n  display: none;\n}\n.file-upload-content[data-v-83b710e3] {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  gap: 8px;\n}\n.file-upload-row[data-v-83b710e3] {\n  display: inline-flex;\n  align-items: center;\n  gap: 12px;\n}\n.upload-icon[data-v-83b710e3] {\n  width: 24px;\n  height: 24px;\n  color: #5e72e4;\n}\n.file-upload-title[data-v-83b710e3] {\n  font-size: 16px;\n  font-weight: 600;\n  color: #5e72e4;\n  letter-spacing: -0.01em;\n}\n.file-upload-subtitle[data-v-83b710e3] {\n  margin-top: 4px;\n  font-size: 13px;\n  color: #7c8de8;\n  font-weight: 500;\n  opacity: 0.9;\n}\n.file-upload-status[data-v-83b710e3] {\n  position: absolute;\n  right: 16px;\n  bottom: 16px;\n  font-size: 12px;\n  padding: 6px 12px;\n  border-radius: 8px;\n  background: rgba(94, 114, 228, 0.15);\n  color: #5e72e4;\n  font-weight: 500;\n}\n.upload-error[data-v-83b710e3] {\n  color: #ef4444;\n  font-size: 14px;\n  font-weight: 500;\n  padding: 12px 16px;\n  background: rgba(239, 68, 68, 0.1);\n  border-radius: 8px;\n  border: 1px solid rgba(239, 68, 68, 0.2);\n  margin: -6px 0 16px;\n}\n.file-loading[data-v-83b710e3] {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 12px;\n  padding: 40px 20px;\n  color: var(--foreground-subdued, #6b7280);\n  font-size: 14px;\n}\n.no-results[data-v-83b710e3] {\n  padding: 40px 20px;\n  text-align: center;\n  color: var(--foreground-subdued, #6b7280);\n  font-size: 14px;\n}\n.file-grid[data-v-83b710e3] {\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n}\n.file-card[data-v-83b710e3] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 16px 20px;\n  border: 1px solid var(--border-color-subdued, #e5e7eb);\n  border-radius: 12px;\n  background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%);\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.04);\n  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n}\n.file-card[data-v-83b710e3]:hover {\n  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.08);\n  transform: translateY(-1px);\n  border-color: var(--border-color, #d1d5db);\n}\n.file-content[data-v-83b710e3] {\n  flex: 1;\n  padding-right: 16px;\n  min-width: 0;\n}\n.file-content h4[data-v-83b710e3] {\n  margin: 0 0 6px 0;\n  font-size: 15px;\n  font-weight: 600;\n  color: var(--foreground, #1a1a1a);\n  letter-spacing: -0.01em;\n  line-height: 1.4;\n}\n.file-content .preview[data-v-83b710e3] {\n  margin: 0;\n  font-size: 13px;\n  color: var(--foreground-subdued, #6b7280);\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  line-height: 1.5;\n}\n.file-actions[data-v-83b710e3] {\n  display: flex;\n  gap: 8px;\n  align-items: center;\n}\n.icon-btn[data-v-83b710e3] {\n  width: 40px;\n  height: 40px;\n  border-radius: 10px;\n  border: 1px solid var(--border-color-subdued, #e5e7eb);\n  background: var(--background, #ffffff);\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);\n}\n.icon-btn[data-v-83b710e3]:hover {\n  background: var(--background-subdued, #f9fafb);\n  border-color: var(--border-color, #d1d5db);\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\n  transform: translateY(-1px);\n}\n.icon-btn[data-v-83b710e3]:active {\n  transform: translateY(0);\n  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);\n}\n.icon[data-v-83b710e3] {\n  width: 18px;\n  height: 18px;\n}\n.icon-btn.view[data-v-83b710e3] {\n  color: #5e72e4;\n}\n.icon-btn.view[data-v-83b710e3]:hover {\n  background: rgba(94, 114, 228, 0.1);\n  border-color: #5e72e4;\n}\n.icon-btn.delete[data-v-83b710e3] {\n  color: #ef4444;\n}\n.icon-btn.delete[data-v-83b710e3]:hover {\n  background: rgba(239, 68, 68, 0.1);\n  border-color: #ef4444;\n}\n",{});const ye={class:"file-tab"},we={class:"file-header"},ke={class:"file-upload-content"},_e={class:"file-upload-row"},ze={key:0,class:"file-upload-status"},Ce={key:0,class:"upload-error"},Ee={key:1,class:"file-loading"},Se={class:"file-grid"},Ae={class:"file-content"},Ie={class:"preview"},qe={class:"file-actions"},Re=["onClick"],Oe=["onClick"];var je=M({__name:"FileTab",setup(n){const t=e(),r=R(),h=a([]),z=a(!1),C=a(""),E=a(""),S=a(!1),A=a(!1),I=a(null);async function q(){z.value=!0,E.value="";try{const e={fields:["id","file.id","file.filename_download","file.type","delete","azienda"],sort:["-date_created"]};r.selectedAzienda?.value&&(e.filter={azienda:{_eq:r.selectedAzienda.value}});let n=[];try{n=(await t.get("/items/file",{params:e})).data.data||[]}catch(a){const r={...e,fields:["id","file.id","file.filename_download","file.type","azienda"]};n=(await t.get("/items/file",{params:r})).data.data||[]}h.value=n}catch(e){h.value=[],E.value="Errore caricamento file"}finally{z.value=!1}}const T=g(()=>C.value?h.value.filter(e=>e.file?.filename_download?.toLowerCase().includes(C.value.toLowerCase())):h.value);function D(){S.value||I.value?.click()}function L(e){const n=e.target.files?.[0];n&&P(n),e.target.value=""}function M(){S.value||(A.value=!0)}function U(){A.value=!1}function $(e){if(S.value)return;A.value=!1;const n=e.dataTransfer?.files?.[0];n&&P(n)}async function P(e){if(e&&!S.value){E.value="",S.value=!0;try{const n=new FormData;n.append("file",e);const a=await t.post("/files",n),i=a?.data?.data,o=i?.id,l=i?.filename_download||e.name||"File";if(!o)return void(E.value="Errore durante il caricamento");const s={file:o,nome:l};r.selectedAzienda?.value&&(s.azienda=r.selectedAzienda.value);let d=null;try{const e=await t.post("/items/file",s);d=e?.data?.data}catch(e){const n={file:o};r.selectedAzienda?.value&&(n.azienda=r.selectedAzienda.value);const a=await t.post("/items/file",n);d=a?.data?.data}d?.id&&(h.value=[d,...h.value.filter(e=>e.id!==d.id)]),await q()}catch(e){E.value="Errore durante il caricamento"}finally{S.value=!1,A.value=!1}}}return m(q),u(()=>r.selectedAzienda?.value,()=>{q()},{immediate:!1}),(e,n)=>{const a=w("v-progress-circular");return o(),i("div",ye,[v(" Header "),l("div",we,[f(l("input",{"onUpdate:modelValue":n[0]||(n[0]=e=>C.value=e),class:"file-search",placeholder:"Cerca file..."},null,512),[[b,C.value]])]),l("div",{class:_(["file-upload",{"is-dragging":A.value,"is-uploading":S.value}]),role:"button",tabindex:"0",onClick:D,onKeydown:k(D,["enter"]),onDragover:p(M,["prevent"]),onDragleave:p(U,["prevent"]),onDrop:p($,["prevent"])},[l("input",{ref_key:"fileInput",ref:I,class:"file-input",type:"file",onChange:L},null,544),l("div",ke,[l("div",_e,[d(c(O),{class:"upload-icon"}),n[1]||(n[1]=l("div",{class:"file-upload-title"},"Trascina un file qui o clicca per caricare",-1))]),n[2]||(n[2]=l("div",{class:"file-upload-subtitle"},"Il file verra aggiunto automaticamente",-1))]),S.value?(o(),i("div",ze,"Caricamento...")):v("v-if",!0)],34),E.value?(o(),i("p",Ce,s(E.value),1)):v("v-if",!0),v(" Loading "),z.value?(o(),i("div",Ee,[d(a,{indeterminate:""}),n[3]||(n[3]=l("span",null,"Caricamento file…",-1))])):T.value.length?v("v-if",!0):(o(),i(x,{key:2},[v(" Empty "),n[4]||(n[4]=l("div",{class:"no-results"}," Nessun file trovato ",-1))],2112)),l("div",Se,[(o(!0),i(x,null,y(T.value,e=>(o(),i("div",{key:e.id,class:"file-card"},[l("div",Ae,[l("h4",null,s(e.file?.filename_download||"File senza nome"),1),l("p",Ie,s(e.file?.type),1)]),l("div",qe,[v(" VIEW "),l("button",{type:"button",class:"icon-btn view",title:"Visualizza file",onClick:n=>function(e){e.file?.id&&window.open(`/assets/${e.file.id}`,"_blank")}(e)},[d(c(j),{class:"icon"})],8,Re),v(" DELETE "),l("button",{type:"button",class:"icon-btn delete",title:"Elimina file",onClick:n=>async function(e){const n=e.file?.filename_download||"questo file";confirm(`Eliminare "${n}"?`)&&(await t.patch(`/items/file/${e.id}`,{delete:!0}),h.value=h.value.filter(n=>n.id!==e.id),await q())}(e)},[d(c(F),{class:"icon"})],8,Oe)])]))),128))])])}}},[["__scopeId","data-v-83b710e3"]]);L('\n.suburl-modal[data-v-c7262699] {\r\n  width: 1000px;\r\n  max-width: 95vw;\r\n  max-height: 90vh;\r\n  display: flex;\r\n  flex-direction: column;\r\n  border-radius: 16px;\r\n  overflow: hidden;\r\n  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);\n}\n.modal-title[data-v-c7262699] {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  gap: 12px;\r\n  text-align: center;\r\n  padding: 24px 32px;\r\n  background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%);\r\n  border-bottom: 1px solid var(--border-normal, #e8e8e8);\n}\n.modal-title[data-v-c7262699] .v-icon {\r\n  width: 24px;\r\n  height: 24px;\r\n  color: #5e72e4;\n}\n.modal-title-text[data-v-c7262699] {\r\n  font-weight: 700;\r\n  font-size: 20px;\r\n  color: var(--foreground, #1a1a1a);\r\n  letter-spacing: -0.02em;\n}\n.loading-container[data-v-c7262699],\r\n.error-container[data-v-c7262699],\r\n.empty-container[data-v-c7262699] {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  justify-content: center;\r\n  gap: 20px;\r\n  padding: 80px 40px;\r\n  color: var(--foreground-subdued, #6b7280);\r\n  min-height: 300px;\n}\n.loading-container[data-v-c7262699] .v-progress-circular {\r\n  width: 48px;\r\n  height: 48px;\n}\n.loading-container span[data-v-c7262699] {\r\n  font-size: 16px;\r\n  font-weight: 500;\n}\n.error-container[data-v-c7262699] {\r\n  color: #ef4444;\n}\n.error-container[data-v-c7262699] .v-icon {\r\n  width: 48px;\r\n  height: 48px;\r\n  color: #ef4444;\n}\n.error-container span[data-v-c7262699] {\r\n  font-size: 15px;\r\n  font-weight: 500;\n}\n.empty-container[data-v-c7262699] .v-icon {\r\n  width: 64px;\r\n  height: 64px;\r\n  color: var(--foreground-subdued, #9ca3af);\r\n  opacity: 0.5;\n}\n.empty-container span[data-v-c7262699] {\r\n  font-size: 15px;\r\n  font-weight: 500;\n}\n.links-container[data-v-c7262699] {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 20px;\r\n  padding: 24px 32px;\r\n  max-height: 60vh;\r\n  overflow-y: auto;\r\n  background: var(--background-page, #f9fafb);\n}\n.links-header[data-v-c7262699] {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  padding: 16px 20px;\r\n  background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%);\r\n  border-radius: 12px;\r\n  border: 1px solid var(--border-normal, #e8e8e8);\r\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.04);\n}\n.links-count[data-v-c7262699] {\r\n  font-weight: 600;\r\n  font-size: 15px;\r\n  color: var(--foreground, #1a1a1a);\r\n  letter-spacing: -0.01em;\n}\n.links-actions[data-v-c7262699] {\r\n  display: flex;\r\n  gap: 12px;\n}\n.btn-link[data-v-c7262699] {\r\n  background: var(--background, #ffffff);\r\n  border: 1px solid var(--border-color-subdued, #e5e7eb);\r\n  color: #5e72e4;\r\n  cursor: pointer;\r\n  font-size: 14px;\r\n  font-weight: 600;\r\n  padding: 8px 16px;\r\n  border-radius: 8px;\r\n  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\r\n  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);\r\n  letter-spacing: -0.01em;\n}\n.btn-link[data-v-c7262699]:hover {\r\n  background: var(--background-subdued, #f9fafb);\r\n  border-color: #5e72e4;\r\n  box-shadow: 0 2px 4px rgba(94, 114, 228, 0.15);\r\n  transform: translateY(-1px);\n}\n.btn-link[data-v-c7262699]:active {\r\n  transform: translateY(0);\r\n  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);\n}\n.links-list[data-v-c7262699] {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 12px;\n}\n.link-item[data-v-c7262699] {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 16px;\r\n  padding: 16px 20px;\r\n  border: 2px solid var(--border-color-subdued, #e5e7eb);\r\n  border-radius: 12px;\r\n  cursor: pointer;\r\n  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\r\n  background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%);\r\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.04);\n}\n.link-item[data-v-c7262699]:hover {\r\n  border-color: #5e72e4;\r\n  background: linear-gradient(135deg, rgba(94, 114, 228, 0.05) 0%, #ffffff 100%);\r\n  box-shadow: 0 4px 8px rgba(94, 114, 228, 0.15);\r\n  transform: translateY(-1px);\n}\n.link-item.selected[data-v-c7262699] {\r\n  border-color: #5e72e4;\r\n  background: linear-gradient(135deg, rgba(94, 114, 228, 0.12) 0%, rgba(124, 141, 232, 0.08) 100%);\r\n  box-shadow: 0 4px 12px rgba(94, 114, 228, 0.2);\n}\n.link-item input[type="checkbox"][data-v-c7262699] {\r\n  width: 20px;\r\n  height: 20px;\r\n  cursor: pointer;\r\n  accent-color: #5e72e4;\r\n  flex-shrink: 0;\n}\n.link-content[data-v-c7262699] {\r\n  flex: 1;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n  gap: 16px;\r\n  min-width: 0;\n}\n.link-url[data-v-c7262699] {\r\n  flex: 1;\r\n  font-size: 15px;\r\n  font-weight: 500;\r\n  color: var(--foreground, #1a1a1a);\r\n  overflow: hidden;\r\n  text-overflow: ellipsis;\r\n  white-space: nowrap;\r\n  letter-spacing: -0.01em;\n}\n.link-badge[data-v-c7262699] {\r\n  font-size: 12px;\r\n  font-weight: 600;\r\n  padding: 6px 12px;\r\n  border-radius: 8px;\r\n  background: linear-gradient(135deg, #10b981 0%, #059669 100%);\r\n  color: white;\r\n  white-space: nowrap;\r\n  box-shadow: 0 2px 4px rgba(16, 185, 129, 0.2);\r\n  letter-spacing: 0.3px;\n}\n.modal-actions[data-v-c7262699] {\r\n  display: flex !important;\r\n  flex-direction: row !important;\r\n  flex-wrap: nowrap !important;\r\n  justify-content: flex-end !important;\r\n  align-items: center !important;\r\n  gap: 12px;\r\n  padding: 24px 32px;\r\n  border-top: 1px solid var(--border-normal, #e8e8e8);\r\n  background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%);\n}\n.modal-actions[data-v-c7262699] * {\r\n  display: flex !important;\r\n  flex-direction: row !important;\r\n  flex-wrap: nowrap !important;\r\n  gap: 12px;\n}\n.modal-actions[data-v-c7262699] .v-button {\r\n  min-width: 140px;\r\n  width: auto;\r\n  height: 44px;\r\n  font-size: 14px;\r\n  font-weight: 600;\r\n  letter-spacing: -0.01em;\r\n  border-radius: 10px;\r\n  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\r\n  display: inline-flex !important;\r\n  align-items: center;\r\n  justify-content: center;\r\n  flex-shrink: 0;\r\n  margin: 0 !important;\n}\n.modal-actions[data-v-c7262699] .v-button--secondary {\r\n  background: var(--background, #ffffff);\r\n  border: 1px solid var(--border-color-subdued, #e5e7eb);\r\n  color: var(--foreground, #1a1a1a);\r\n  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05), 0 1px 3px rgba(0, 0, 0, 0.1);\n}\n.modal-actions[data-v-c7262699] .v-button--secondary:hover {\r\n  background: var(--background-subdued, #f9fafb);\r\n  border-color: var(--border-color, #d1d5db);\r\n  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.07), 0 2px 4px rgba(0, 0, 0, 0.06);\r\n  transform: translateY(-1px);\n}\n.modal-actions[data-v-c7262699] .v-button--primary {\r\n  background: linear-gradient(135deg, #5e72e4 0%, #7c8de8 100%);\r\n  border: 1px solid #5e72e4;\r\n  box-shadow: 0 1px 2px rgba(94, 114, 228, 0.2), 0 1px 3px rgba(94, 114, 228, 0.1);\n}\n.modal-actions[data-v-c7262699] .v-button--primary:hover:not(:disabled) {\r\n  box-shadow: 0 4px 6px rgba(94, 114, 228, 0.25), 0 2px 4px rgba(94, 114, 228, 0.15);\r\n  transform: translateY(-1px);\n}\n.modal-actions[data-v-c7262699] .v-button--primary:active:not(:disabled) {\r\n  transform: translateY(0);\r\n  box-shadow: 0 1px 2px rgba(94, 114, 228, 0.2);\n}\r\n\r\n/* Scrollbar personalizzata */\n.links-container[data-v-c7262699]::-webkit-scrollbar {\r\n  width: 10px;\n}\n.links-container[data-v-c7262699]::-webkit-scrollbar-track {\r\n  background: var(--background-subdued, #f9fafb);\r\n  border-radius: 5px;\n}\n.links-container[data-v-c7262699]::-webkit-scrollbar-thumb {\r\n  background: #d1d5db;\r\n  border-radius: 5px;\r\n  border: 2px solid var(--background-subdued, #f9fafb);\n}\n.links-container[data-v-c7262699]::-webkit-scrollbar-thumb:hover {\r\n  background: #9ca3af;\n}\r\n',{});const Fe={key:0,class:"loading-container"},Te={key:1,class:"error-container"},De={key:2,class:"empty-container"},Le={key:3,class:"links-container"},Me={class:"links-header"},Ue={class:"links-count"},$e={class:"links-list"},Pe=["onClick"],Ne=["checked","onClick"],Ve={class:"link-content"},Ye={class:"link-url"},Be={key:0,class:"link-badge"},Qe={class:"modal-actions"},We={__name:"SubUrlSelectorModal",props:{open:{type:Boolean,default:!1},parentUrlId:{type:[String,Number],default:null}},emits:["update:open","close","confirmed","timeout"],setup(n,{emit:t}){const r=n,c=t,f=e(),b=a([]),m=a(!1),k=a(!1),E=a(""),S=a([]),A=a("Caricamento link..."),I=a(null),q=g(()=>S.value.length);function R(e){!e&&r.open||c("update:open",e)}function O(e){const n=S.value.indexOf(e);-1===n?S.value.push(e):S.value.splice(n,1)}function j(){S.value=b.value.filter(e=>!e.to_process).map(e=>e.id)}function F(){S.value=[]}async function T(){if(0!==S.value.length&&!k.value&&r.parentUrlId){k.value=!0;try{const e=await f.get(`/items/sitoweb/${r.parentUrlId}`,{params:{fields:["id","sottourl"]}}),n=e?.data?.data;if(!n||!n.sottourl)throw new Error("Record non trovato o sottourl non disponibile");let a,t,i="array";try{if(Array.isArray(n.sottourl))a=[...n.sottourl],i="array";else if("string"==typeof n.sottourl)a=JSON.parse(n.sottourl),i="string";else{if("object"!=typeof n.sottourl||null===n.sottourl)throw new Error("Formato sottourl non supportato");a=Array.isArray(n.sottourl)?[...n.sottourl]:Object.values(n.sottourl),i="object"}}catch(e){throw new Error("Errore nel parsing del JSON sottourl")}a=a.map((e,n)=>{const a=e.id||e.url||`link_${n}`;return S.value.includes(a)?{...e,to_process:!0}:e}),t="string"===i?JSON.stringify(a):a,await f.patch(`/items/sitoweb/${r.parentUrlId}`,{sottourl:t}),c("confirmed",S.value),c("update:open",!1),c("close")}catch(e){E.value=e?.message||"Errore durante l'aggiornamento dei link"}finally{k.value=!1}}}function D(){b.value=[],S.value=[],E.value="",m.value=!1,k.value=!1}return u(()=>r.open,e=>{e&&r.parentUrlId?(D(),async function(){if(!r.parentUrlId)return;m.value=!0,E.value="",A.value="Caricamento in corso...";const e=Date.now();try{for(;Date.now()-e<5e4;)try{const e=await f.get(`/items/sitoweb/${r.parentUrlId}`,{params:{fields:["id","sottourl","url"]}}),n=e?.data?.data;if(n&&n.sottourl){let e=[];try{Array.isArray(n.sottourl)?e=n.sottourl:"string"==typeof n.sottourl?e=JSON.parse(n.sottourl):"object"==typeof n.sottourl&&(e=Object.values(n.sottourl))}catch(e){await new Promise(e=>setTimeout(e,500));continue}if(Array.isArray(e)&&e.length>0&&(b.value=e.map((e,n)=>{if("string"==typeof e)return{id:`link_${n}`,url:e,to_process:!1,_original:e};const a=e.id||e.url||`link_${n}`;return{...e,id:a,to_process:void 0!==e.to_process&&e.to_process}}),b.value.length>0))return void(m.value=!1)}await new Promise(e=>setTimeout(e,500))}catch(e){if(404===e?.response?.status){await new Promise(e=>setTimeout(e,500));continue}if(e?.response?.status>=500){await new Promise(e=>setTimeout(e,500));continue}throw e}0===b.value.length&&(E.value="Nessun link trovato entro il timeout",m.value=!1,c("timeout",r.parentUrlId))}catch(e){E.value=e?.message||"Errore durante il caricamento dei link",m.value=!1,c("timeout",r.parentUrlId)}}()):e||(D(),I.value&&(clearTimeout(I.value),I.value=null))},{immediate:!0}),(e,a)=>{const t=w("v-icon"),r=w("v-card-title"),c=w("v-progress-circular"),u=w("v-card-text"),f=w("v-button"),g=w("v-card"),I=w("v-dialog");return o(),h(I,{"model-value":n.open,"onUpdate:modelValue":R,onEsc:a[2]||(a[2]=n=>e.$emit("close")),persistent:""},{default:z(()=>[d(g,{class:"suburl-modal"},{default:z(()=>[d(r,{class:"modal-title"},{default:z(()=>[d(t,{name:"link"}),a[3]||(a[3]=l("span",{class:"modal-title-text"},"Seleziona i link da processare",-1))]),_:1}),d(u,{style:{padding:"0"}},{default:z(()=>[m.value?(o(),i("div",Fe,[d(c,{indeterminate:""}),l("span",null,s(A.value),1)])):E.value?(o(),i("div",Te,[d(t,{name:"error"}),l("span",null,s(E.value),1)])):0===b.value.length?(o(),i("div",De,[d(t,{name:"link_off"}),a[4]||(a[4]=l("span",null,"Nessun link trovato",-1))])):(o(),i("div",Le,[l("div",Me,[l("span",Ue,s(q.value)+" / "+s(b.value.length)+" selezionati",1),l("div",{class:"links-actions"},[l("button",{type:"button",class:"btn-link",onClick:j}," Seleziona tutto "),l("button",{type:"button",class:"btn-link",onClick:F}," Deseleziona tutto ")])]),l("div",$e,[(o(!0),i(x,null,y(b.value,e=>(o(),i("div",{key:e.id,class:_(["link-item",{selected:S.value.includes(e.id)}]),onClick:n=>O(e.id)},[l("input",{type:"checkbox",checked:S.value.includes(e.id),onClick:p(n=>O(e.id),["stop"]),onChange:a[0]||(a[0]=p(()=>{},["prevent"]))},null,40,Ne),l("div",Ve,[l("span",Ye,s(e.url||e.sottourl||"N/A"),1),e.to_process?(o(),i("span",Be,"Già processato")):v("v-if",!0)])],10,Pe))),128))])]))]),_:1}),l("div",Qe,[d(f,{onClick:a[1]||(a[1]=n=>e.$emit("close")),secondary:""},{default:z(()=>[...a[5]||(a[5]=[C("Annulla",-1)])]),_:1}),d(f,{onClick:T,disabled:m.value||0===S.value.length||k.value,loading:k.value},{default:z(()=>[C(s(k.value?"Elaborazione...":"Conferma"),1)]),_:1},8,["disabled","loading"])])]),_:1})]),_:1},8,["model-value"])}}};var He=M(We,[["__scopeId","data-v-c7262699"]]);L("\n.site-tab[data-v-14caf14f] {\n  display: grid;\n  gap: 20px;\n}\n.site-header[data-v-14caf14f] {\n  display: flex;\n  align-items: center;\n  gap: 16px;\n  margin-bottom: 32px;\n  padding-bottom: 24px;\n  border-bottom: 1px solid var(--border-normal, #e8e8e8);\n  flex-wrap: wrap;\n}\n.site-search[data-v-14caf14f] {\n  width: 360px;\n  height: 44px;\n  padding: 0 16px;\n  border-radius: 10px;\n  border: 1px solid var(--border-color-subdued, #e5e7eb);\n  font: inherit;\n  font-size: 14px;\n  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n  background: var(--background, #ffffff);\n  color: var(--foreground, #1a1a1a);\n}\n.site-search[data-v-14caf14f]:focus {\n  outline: none;\n  border-color: var(--primary, #5e72e4);\n  box-shadow: 0 0 0 3px rgba(94, 114, 228, 0.1);\n}\n.site-add[data-v-14caf14f] {\n  display: flex;\n  align-items: center;\n  gap: 12px;\n  margin-bottom: 24px;\n}\n.site-url[data-v-14caf14f] {\n  flex: 1;\n  min-width: 520px;\n  height: 44px;\n  padding: 0 16px;\n  border-radius: 10px;\n  border: 1px solid var(--border-color-subdued, #e5e7eb);\n  font: inherit;\n  font-size: 14px;\n  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n  background: var(--background, #ffffff);\n  color: var(--foreground, #1a1a1a);\n}\n.site-url[data-v-14caf14f]:focus {\n  outline: none;\n  border-color: var(--primary, #5e72e4);\n  box-shadow: 0 0 0 3px rgba(94, 114, 228, 0.1);\n}\n.btn-primary[data-v-14caf14f] {\n  height: 44px;\n  background: linear-gradient(135deg, #5e72e4 0%, #7c8de8 100%);\n  color: white;\n  border-radius: 10px;\n  border: 1px solid #5e72e4;\n  padding: 0 20px;\n  cursor: pointer;\n  white-space: nowrap;\n  font-size: 14px;\n  font-weight: 600;\n  letter-spacing: -0.01em;\n  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n  box-shadow: 0 1px 2px rgba(94, 114, 228, 0.2), 0 1px 3px rgba(94, 114, 228, 0.1);\n}\n.btn-primary[data-v-14caf14f]:hover:not(:disabled) {\n  box-shadow: 0 4px 6px rgba(94, 114, 228, 0.25), 0 2px 4px rgba(94, 114, 228, 0.15);\n  transform: translateY(-1px);\n}\n.btn-primary[data-v-14caf14f]:active:not(:disabled) {\n  transform: translateY(0);\n  box-shadow: 0 1px 2px rgba(94, 114, 228, 0.2);\n}\n.btn-primary[data-v-14caf14f]:disabled {\n  opacity: 0.6;\n  cursor: not-allowed;\n}\n.site-list[data-v-14caf14f] {\n  display: grid;\n  gap: 12px;\n}\n.site-card[data-v-14caf14f] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 16px 20px;\n  border: 1px solid var(--border-color-subdued, #e5e7eb);\n  border-radius: 12px;\n  background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%);\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.04);\n  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n}\n.site-card[data-v-14caf14f]:hover {\n  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.08);\n  transform: translateY(-1px);\n  border-color: var(--border-color, #d1d5db);\n}\n.site-content[data-v-14caf14f] {\n  flex: 1;\n  padding-right: 16px;\n  min-width: 0;\n}\n.site-content h4[data-v-14caf14f] {\n  margin: 0;\n  font-size: 15px;\n  font-weight: 600;\n  color: var(--foreground, #1a1a1a);\n  letter-spacing: -0.01em;\n}\n.site-actions-inline[data-v-14caf14f] {\n  display: flex;\n  gap: 8px;\n  align-items: center;\n}\n.icon-btn[data-v-14caf14f] {\n  width: 40px;\n  height: 40px;\n  border-radius: 10px;\n  border: 1px solid var(--border-color-subdued, #e5e7eb);\n  background: var(--background, #ffffff);\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);\n}\n.icon-btn[data-v-14caf14f]:hover {\n  background: var(--background-subdued, #f9fafb);\n  border-color: var(--border-color, #d1d5db);\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\n  transform: translateY(-1px);\n}\n.icon-btn[data-v-14caf14f]:active {\n  transform: translateY(0);\n  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);\n}\n.icon[data-v-14caf14f] {\n  width: 18px;\n  height: 18px;\n}\n.icon-btn.delete[data-v-14caf14f] {\n  color: #ef4444;\n}\n.icon-btn.delete[data-v-14caf14f]:hover {\n  background: rgba(239, 68, 68, 0.1);\n  border-color: #ef4444;\n}\n.upload-indicator[data-v-14caf14f] {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  padding: 6px 14px;\n  background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%);\n  border-radius: 8px;\n  border: 1px solid var(--border-normal, #e8e8e8);\n  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.04);\n}\n.upload-text[data-v-14caf14f] {\n  font-size: 13px;\n  color: var(--foreground-subdued, #6b7280);\n  font-weight: 500;\n}\n.error[data-v-14caf14f] {\n  color: #ef4444;\n  font-size: 14px;\n  font-weight: 500;\n  padding: 12px 16px;\n  background: rgba(239, 68, 68, 0.1);\n  border-radius: 8px;\n  border: 1px solid rgba(239, 68, 68, 0.2);\n  margin-top: 8px;\n}\n",{});const Ke={class:"site-tab"},Je={class:"site-header"},Ze={class:"site-add"},Ge=["disabled"],Xe={key:0,class:"error"},en={key:1,class:"site-loading"},nn={key:2,class:"no-results"},an={class:"site-list"},tn={class:"site-content"},rn={class:"site-actions-inline"},on={key:0,class:"upload-indicator"},ln=["onClick"],sn="sitoweb",dn={__name:"SitoWebTab",setup(n){const t=e(),r=R(),p=a([]),h=a(!1),k=a(""),_=a(!1),z=a(""),C=a(""),S=a(!1),A=a(null),I=a(new Set),q=a(new Map),O=g(()=>{if(!k.value)return p.value;const e=k.value.toLowerCase();return p.value.filter(n=>String(n?.url||"").toLowerCase().includes(e))});async function j(){h.value=!0;try{const e={limit:100,sort:["-date_created"],fields:["id","url","upload","azienda","date_created","delete"]},n={delete:{_neq:!0}};r.selectedAzienda?.value&&(n.azienda={_eq:r.selectedAzienda.value}),e.filter=n;const a=await t.get(`/items/${sn}`,{params:e}),i=a?.data?.data??[];p.value=i,z.value="",i.forEach(e=>{!e.id||e.upload||I.value.has(e.id)?e.upload&&I.value.has(e.id)&&D(e.id):T(e.id)})}catch(e){p.value=[],z.value="Errore caricamento siti"}finally{h.value=!1}}function T(e){if(q.value.has(e))return;I.value.add(e);const n=setInterval(async()=>{try{const n=await t.get(`/items/${sn}/${e}`,{params:{fields:["id","upload"]}}),a=n?.data?.data;if(a&&!0===a.upload){D(e);const n=p.value.findIndex(n=>n.id===e);-1!==n&&(p.value[n].upload=!0)}}catch(e){console.error("Errore durante il polling upload:",e)}},2e3);q.value.set(e,n)}function D(e){const n=q.value.get(e);n&&(clearInterval(n),q.value.delete(e)),I.value.delete(e)}async function L(){if(_.value)return;const e=C.value.trim();if(!e)return void(z.value="Inserisci un URL valido");_.value=!0,z.value="";let n=null;const a={url:e};if(r.selectedAzienda?.value){a.azienda=r.selectedAzienda.value;try{const e=await t.get("/items/clienti",{params:{filter:{azienda:{_eq:r.selectedAzienda.value}},fields:["agent_elevenlabs","id_user","id_branch"],limit:1}}),n=e?.data?.data?.[0];n&&(n.agent_elevenlabs&&(a.id_agente=n.agent_elevenlabs),n.id_user&&(a.id_user=n.id_user),n.id_branch&&(a.id_branch=n.id_branch))}catch(e){console.warn("Errore nel recupero dati cliente:",e)}}try{try{n=(await t.post(`/items/${sn}`,a))?.data?.data}catch(i){const o={nome:e,url:e};r.selectedAzienda?.value&&(o.azienda=r.selectedAzienda.value,a.id_agente&&(o.id_agente=a.id_agente),a.id_user&&(o.id_user=a.id_user),a.id_branch&&(o.id_branch=a.id_branch)),n=(await t.post(`/items/${sn}`,o))?.data?.data}n?.id&&(A.value=n.id,S.value=!0,C.value="",k.value="")}catch(e){z.value=e?.message||"Errore durante il salvataggio. Il sito non è stato salvato.",S.value=!1,A.value=null}finally{_.value=!1}}async function M(){if(A.value)try{await t.delete(`/items/${sn}/${A.value}`),p.value=p.value.filter(e=>e.id!==A.value),D(A.value)}catch(e){console.error("Errore durante eliminazione record:",e)}S.value=!1,A.value=null}function U(e){A.value&&T(A.value),j()}async function $(e){if(e)try{await t.delete(`/items/${sn}/${e}`),await j()}catch(e){z.value="Errore durante l'eliminazione del record"}M()}return m(j),u(()=>r.selectedAzienda?.value,()=>{q.value.forEach((e,n)=>{D(n)}),j()},{immediate:!1}),E(()=>{q.value.forEach((e,n)=>{D(n)})}),(e,n)=>{const a=w("v-progress-circular");return o(),i("div",Ke,[l("div",Je,[f(l("input",{"onUpdate:modelValue":n[0]||(n[0]=e=>k.value=e),class:"site-search",placeholder:"Cerca sito…"},null,512),[[b,k.value]])]),l("div",Ze,[f(l("input",{"onUpdate:modelValue":n[1]||(n[1]=e=>C.value=e),class:"site-url",placeholder:"Inserisci un link (es. https://www.esempio.it)"},null,512),[[b,C.value]]),l("button",{class:"btn-primary",type:"button",onClick:L,disabled:_.value},s(_.value?"Salvataggio…":"Aggiungi"),9,Ge)]),z.value?(o(),i("p",Xe,s(z.value),1)):v("v-if",!0),h.value?(o(),i("div",en,[d(a,{indeterminate:""}),n[3]||(n[3]=l("span",null,"Caricamento siti…",-1))])):O.value.length?v("v-if",!0):(o(),i("div",nn," Nessun sito trovato ")),l("div",an,[(o(!0),i(x,null,y(O.value,e=>(o(),i("div",{key:e.id,class:"site-card"},[l("div",tn,[l("h4",null,s(e.url),1)]),l("div",rn,[v(" Indicatore di caricamento per upload "),I.value.has(e.id)?(o(),i("div",on,[d(a,{indeterminate:"",size:"20"}),n[4]||(n[4]=l("span",{class:"upload-text"},"Caricamento...",-1))])):v("v-if",!0),l("button",{type:"button",class:"icon-btn delete",title:"Elimina sito",onClick:n=>async function(e){if(!confirm(`Eliminare "${e.url}"?`))return;z.value="";const n=e.id;try{await t.patch(`/items/${sn}/${n}`,{delete:!0}),p.value=p.value.filter(n=>n.id!==e.id),setTimeout(async()=>{try{await t.delete(`/items/${sn}/${n}`)}catch(e){console.error("Errore durante eliminazione definitiva del sito:",e)}},1e4)}catch(e){z.value=e?.message||"Errore durante eliminazione sito"}}(e)},[d(c(F),{class:"icon"})],8,ln)])]))),128))]),v(" Modal per selezione sottourl "),d(He,{open:S.value,"parent-url-id":A.value,"onUpdate:open":n[2]||(n[2]=e=>S.value=e),onClose:M,onConfirmed:U,onTimeout:$},null,8,["open","parent-url-id"])])}}};var cn=M(dn,[["__scopeId","data-v-14caf14f"]]);L("\n.base-conoscenza[data-v-d759033d] {\r\n  padding: 40px;\r\n  max-width: 1400px;\r\n  margin: 0 auto;\n}\n.tabs-header[data-v-d759033d] {\r\n  display: flex;\r\n  gap: 8px;\r\n  margin-bottom: 32px;\r\n  border-bottom: 2px solid var(--border-normal, #e8e8e8);\r\n  padding-bottom: 0;\r\n  width: 100%;\n}\n.tab-button[data-v-d759033d] {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 10px;\r\n  padding: 14px 28px;\r\n  flex: 1;\r\n  justify-content: center;\r\n  background: transparent;\r\n  border: none;\r\n  border-bottom: 3px solid transparent;\r\n  color: var(--foreground-subdued, #6b7280);\r\n  font-size: 15px;\r\n  font-weight: 600;\r\n  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\r\n  margin-bottom: -2px;\r\n  letter-spacing: -0.01em;\r\n  cursor: pointer;\n}\n.tab-button[data-v-d759033d]:hover {\r\n  color: var(--foreground, #1a1a1a);\r\n  background: var(--background-subdued, #f9fafb);\n}\n.tab-button.active[data-v-d759033d] {\r\n  color: var(--primary, #5e72e4);\r\n  border-bottom-color: var(--primary, #5e72e4);\r\n  background: linear-gradient(135deg, rgba(94, 114, 228, 0.05) 0%, rgba(255, 255, 255, 0) 100%);\n}\n.tab-content[data-v-d759033d] {\r\n  animation: fadeIn-d759033d 0.3s ease;\n}\n@keyframes fadeIn-d759033d {\nfrom {\r\n    opacity: 0;\r\n    transform: translateY(8px);\n}\nto {\r\n    opacity: 1;\r\n    transform: translateY(0);\n}\n}\r\n",{});const un={class:"base-conoscenza"},pn={class:"tabs-header"},fn={key:0,class:"tab-content"},vn={key:1,class:"tab-content"},bn={key:2,class:"tab-content"};var gn=M({__name:"KnowledgeBaseView",setup(e){const n=a("faq");function t(e){n.value=e}return(e,a)=>{const r=w("v-icon");return o(),i("div",un,[v(" Tabs "),l("div",pn,[l("button",{class:_(["tab-button",{active:"faq"===n.value}]),onClick:a[0]||(a[0]=e=>t("faq"))},[d(r,{name:"help_outline",small:""}),a[3]||(a[3]=C(" FAQ ",-1))],2),l("button",{class:_(["tab-button",{active:"sito-web"===n.value}]),onClick:a[1]||(a[1]=e=>t("sito-web"))},[d(r,{name:"language",small:""}),a[4]||(a[4]=C(" Sito Web ",-1))],2),l("button",{class:_(["tab-button",{active:"file"===n.value}]),onClick:a[2]||(a[2]=e=>t("file"))},[d(r,{name:"description",small:""}),a[5]||(a[5]=C(" File ",-1))],2)]),v(" FAQ Tab Content "),"faq"===n.value?(o(),i("div",fn,[d(xe)])):v("v-if",!0),v(" Sito Web Tab Content "),"sito-web"===n.value?(o(),i("div",vn,[d(cn)])):v("v-if",!0),v(" File Tab Content "),"file"===n.value?(o(),i("div",bn,[d(je)])):v("v-if",!0)])}}},[["__scopeId","data-v-d759033d"]]);L("\n.prompt-view[data-v-9905049a] {\r\n  padding: 40px;\r\n  max-width: 1400px;\r\n  margin: 0 auto;\n}\n.prompt-layout[data-v-9905049a] {\r\n  display: flex;\r\n  align-items: flex-start;\r\n  gap: 32px;\n}\n.prompt-main[data-v-9905049a] {\r\n  flex: 2;\r\n  min-width: 0;\n}\n.prompt-sidebar[data-v-9905049a] {\r\n  flex: 1;\r\n  min-width: 260px;\n}\n.prompt-title[data-v-9905049a] {\r\n  font-size: 18px;\r\n  font-weight: 700;\r\n  margin: 0 0 16px;\r\n  color: var(--foreground, #1a1a1a);\r\n  letter-spacing: -0.02em;\n}\n.prompt-title + .prompt-textarea[data-v-9905049a] {\r\n  margin-bottom: 24px;\n}\n.prompt-textarea[data-v-9905049a] {\r\n  width: 100%;\r\n  min-height: 360px;\r\n  padding: 20px;\r\n  border-radius: 12px;\r\n  border: 1px solid var(--border-color-subdued, #e5e7eb);\r\n  font: inherit;\r\n  font-size: 14px;\r\n  line-height: 1.6;\r\n  resize: vertical;\r\n  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\r\n  background: var(--background, #ffffff);\r\n  color: var(--foreground, #1a1a1a);\r\n  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);\n}\n.prompt-textarea[data-v-9905049a]:focus {\r\n  outline: none;\r\n  border-color: var(--primary, #5e72e4);\r\n  box-shadow: 0 0 0 3px rgba(94, 114, 228, 0.1), 0 2px 4px rgba(0, 0, 0, 0.08);\n}\n.prompt-textarea--small[data-v-9905049a] {\r\n  min-height: auto;\n}\n.prompt-textarea[data-v-9905049a]:read-only {\r\n  background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%);\r\n  cursor: text;\n}\n.prompt-actions[data-v-9905049a] {\r\n  display: flex;\r\n  justify-content: flex-end;\r\n  gap: 12px;\r\n  margin-top: 20px;\r\n  margin-bottom: 40px;\n}\n.prompt-error[data-v-9905049a] {\r\n  margin-top: 16px;\r\n  color: #ef4444;\r\n  font-size: 14px;\r\n  font-weight: 500;\r\n  padding: 12px 16px;\r\n  background: rgba(239, 68, 68, 0.1);\r\n  border-radius: 8px;\r\n  border: 1px solid rgba(239, 68, 68, 0.2);\n}\n.btn-primary[data-v-9905049a],\r\n.btn-ghost[data-v-9905049a] {\r\n  height: 44px;\r\n  border-radius: 10px;\r\n  padding: 0 20px;\r\n  cursor: pointer;\r\n  white-space: nowrap;\r\n  font-size: 14px;\r\n  font-weight: 600;\r\n  letter-spacing: -0.01em;\r\n  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n}\n.btn-primary[data-v-9905049a] {\r\n  background: linear-gradient(135deg, #5e72e4 0%, #7c8de8 100%);\r\n  color: #fff;\r\n  border: 1px solid #5e72e4;\r\n  box-shadow: 0 1px 2px rgba(94, 114, 228, 0.2), 0 1px 3px rgba(94, 114, 228, 0.1);\n}\n.btn-primary[data-v-9905049a]:hover:not(:disabled) {\r\n  box-shadow: 0 4px 6px rgba(94, 114, 228, 0.25), 0 2px 4px rgba(94, 114, 228, 0.15);\r\n  transform: translateY(-1px);\n}\n.btn-primary[data-v-9905049a]:active:not(:disabled) {\r\n  transform: translateY(0);\r\n  box-shadow: 0 1px 2px rgba(94, 114, 228, 0.2);\n}\n.btn-ghost[data-v-9905049a] {\r\n  background: var(--background, #ffffff);\r\n  color: var(--foreground, #1a1a1a);\r\n  border: 1px solid var(--border-color-subdued, #e5e7eb);\r\n  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05), 0 1px 3px rgba(0, 0, 0, 0.1);\n}\n.btn-ghost[data-v-9905049a]:hover:not(:disabled) {\r\n  background: var(--background-subdued, #f9fafb);\r\n  border-color: var(--border-color, #d1d5db);\r\n  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.07), 0 2px 4px rgba(0, 0, 0, 0.06);\r\n  transform: translateY(-1px);\n}\n.btn-ghost[data-v-9905049a]:active:not(:disabled) {\r\n  transform: translateY(0);\r\n  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);\n}\n.btn-primary[data-v-9905049a]:disabled,\r\n.btn-ghost[data-v-9905049a]:disabled {\r\n  opacity: 0.6;\r\n  cursor: not-allowed;\r\n  transform: none;\n}\n.voice-panel[data-v-9905049a] {\r\n  box-sizing: border-box;\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 12px;\r\n  min-height: 360px;\n}\n.voice-panel-header[data-v-9905049a] {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n  margin-top: 34px;\n}\n.voice-title[data-v-9905049a] {\r\n  font-size: 13px;\r\n  font-weight: 600;\r\n  margin: 0;\r\n  color: var(--foreground-subdued, #6b7280);\r\n  letter-spacing: 0.2px;\r\n  text-transform: uppercase;\n}\n.voice-field[data-v-9905049a] {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 8px;\n}\n.voice-preview[data-v-9905049a] {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 12px;\r\n  padding: 12px 14px;\r\n  border-radius: 14px;\r\n  border: 1px solid var(--border-color-subdued, #e5e7eb);\r\n  background: var(--background, #ffffff);\r\n  box-shadow: 0 6px 16px rgba(0, 0, 0, 0.08);\n}\n.voice-preview-avatar[data-v-9905049a] {\r\n  width: 36px;\r\n  height: 36px;\r\n  border-radius: 50%;\r\n  background: #d1fae5;\r\n  color: #065f46;\r\n  font-weight: 700;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\n}\n.voice-preview-content[data-v-9905049a] {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 4px;\n}\n.voice-preview-name[data-v-9905049a] {\r\n  font-size: 15px;\r\n  font-weight: 600;\r\n  color: var(--foreground, #1a1a1a);\n}\n.voice-badge[data-v-9905049a] {\r\n  align-self: flex-start;\r\n  padding: 2px 8px;\r\n  border-radius: 999px;\r\n  font-size: 12px;\r\n  font-weight: 600;\r\n  color: #475569;\r\n  background: #f1f5f9;\n}\n.voice-divider[data-v-9905049a] {\r\n  height: 1px;\r\n  width: 100%;\r\n  background: var(--border-color-subdued, #e5e7eb);\r\n  opacity: 0.7;\n}\n.voice-label[data-v-9905049a] {\r\n  font-size: 13px;\r\n  font-weight: 600;\r\n  color: var(--foreground-subdued, #6b7280);\r\n  letter-spacing: 0.2px;\n}\n.voice-select[data-v-9905049a] {\r\n  min-height: 52px;\r\n  border-radius: 14px;\r\n  border: 1px solid var(--border-color-subdued, #e5e7eb);\r\n  padding: 10px 40px 10px 14px;\r\n  font: inherit;\r\n  background: var(--background, #ffffff)\r\n    url(\"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='14' height='14' viewBox='0 0 24 24' fill='none' stroke='%236b7280' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'><polyline points='6 9 12 15 18 9'/></svg>\")\r\n    no-repeat right 14px center;\r\n  color: var(--foreground, #1a1a1a);\r\n  box-shadow: 0 6px 16px rgba(0, 0, 0, 0.08);\r\n  appearance: none;\n}\n.voice-select[data-v-9905049a]:focus {\r\n  outline: none;\r\n  border-color: var(--primary, #5e72e4);\r\n  box-shadow: 0 0 0 3px rgba(94, 114, 228, 0.1);\n}\n.voice-details[data-v-9905049a] {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 12px;\r\n  margin-top: 12px;\n}\n.voice-description[data-v-9905049a] {\r\n  font-size: 14px;\r\n  line-height: 1.7;\r\n  font-weight: 500;\r\n  color: var(--foreground, #1a1a1a);\r\n  background: #f8fafc;\r\n  padding: 14px 16px;\r\n  border-radius: 10px;\r\n  border: 1px solid var(--border-color-subdued, #e5e7eb);\n}\n.voice-audio[data-v-9905049a] {\r\n  width: 100%;\n}\n.voice-hint[data-v-9905049a] {\r\n  font-size: 13px;\r\n  color: var(--foreground-subdued, #6b7280);\r\n  margin: 0 0 8px;\n}\n.voice-error[data-v-9905049a] {\r\n  margin-top: 12px;\r\n  color: #ef4444;\r\n  font-size: 13px;\r\n  font-weight: 600;\n}\n@media (max-width: 1100px) {\n.prompt-layout[data-v-9905049a] {\r\n    flex-direction: column;\n}\n.prompt-sidebar[data-v-9905049a] {\r\n    width: 100%;\n}\n}\r\n",{});const mn={class:"prompt-view"},hn={class:"prompt-layout"},xn={class:"prompt-main"},yn=["readonly"],wn={class:"prompt-actions"},kn=["disabled"],_n=["disabled"],zn=["readonly"],Cn={class:"prompt-actions"},En=["disabled"],Sn=["disabled"],An={key:0,class:"prompt-error"},In={class:"prompt-sidebar"},qn={class:"voice-panel"},Rn={class:"voice-preview"},On={class:"voice-preview-avatar"},jn={class:"voice-preview-content"},Fn={class:"voice-preview-name"},Tn={key:0,class:"voice-badge"},Dn={class:"voice-field"},Ln=["disabled"],Mn=["value"],Un={key:0,class:"voice-hint"},$n={key:1,class:"voice-hint"},Pn={key:2,class:"voice-details"},Nn={class:"voice-description"},Vn=["src"],Yn={key:0,class:"voice-hint"},Bn={key:3,class:"voice-error"},Qn={__name:"PromptEditor",setup(n){const t=R(),r=e(),{promptDisplay:d,firstMessageDisplay:p,promptEditing:h,firstMessageEditing:w,promptError:k,loadPrompt:_,startPromptEdit:z,startFirstMessageEdit:C,cancelPromptEdit:E,cancelFirstMessageEdit:I,savePrompt:q,saveFirstMessage:O}=function(n=null){const t=e(),r=a(null),i=a(""),o=a(""),l=a(""),s=a(""),d=a(!1),c=a(!1),u=a(!1),p=a(!1),f=a(""),v=g({get:()=>d.value?o.value:i.value,set:e=>{d.value&&(o.value=e)}}),b=g({get:()=>c.value?s.value:l.value,set:e=>{c.value&&(s.value=e)}});return{promptId:r,promptValue:i,promptDraft:o,firstMessageValue:l,firstMessageDraft:s,promptEditing:d,firstMessageEditing:c,promptSaving:u,firstMessageSaving:p,promptError:f,promptDisplay:v,firstMessageDisplay:b,loadPrompt:async function(){f.value="";try{const e={fields:["id","testo_prompt","primo_messaggio","azienda"],limit:1};n?.value&&(e.filter={azienda:{_eq:n.value}});const a=await t.get("/items/prompt",{params:e}),u=a?.data?.data?.[0];if(!u){if(!n?.value)return void(f.value="Prompt non disponibile");try{const e=await t.post("/items/prompt",{azienda:n.value,testo_prompt:"",primo_messaggio:""});return r.value=e?.data?.data?.id,i.value="",l.value="",d.value||(o.value=""),void(c.value||(s.value=""))}catch(e){return void(f.value=`Errore durante la creazione del prompt per l'azienda "${n.value}"`)}}r.value=u.id,i.value=u.testo_prompt||"",l.value=u.primo_messaggio||"",d.value||(o.value=i.value),c.value||(s.value=l.value)}catch(e){f.value="Errore caricamento prompt"}},startPromptEdit:function(){d.value||c.value||(f.value="",o.value=i.value,d.value=!0)},startFirstMessageEdit:function(){d.value||c.value||(f.value="",s.value=l.value,c.value=!0)},cancelPromptEdit:function(){o.value=i.value,d.value=!1},cancelFirstMessageEdit:function(){s.value=l.value,c.value=!1},savePrompt:async function(){if(d.value&&!u.value)if(r.value){u.value=!0,f.value="";try{const e={testo_prompt:o.value};n?.value&&(e.azienda=n.value),await t.patch(`/items/prompt/${r.value}`,e),i.value=o.value,d.value=!1}catch(e){f.value="Errore durante il salvataggio del prompt"}finally{u.value=!1}}else f.value="Prompt non disponibile"},saveFirstMessage:async function(){if(c.value&&!p.value)if(r.value){p.value=!0,f.value="";try{const e={primo_messaggio:s.value};n?.value&&(e.azienda=n.value),await t.patch(`/items/prompt/${r.value}`,e),l.value=s.value,c.value=!1}catch(e){f.value="Errore durante il salvataggio del primo messaggio"}finally{p.value=!1}}else f.value="Prompt non disponibile"}}}(t),j=a([]),F=a(!1),T=a(""),D=a(""),L=g(()=>j.value.find(e=>e.id===D.value)),M=g(()=>$(j.value)),U=g(()=>{const e=L.value?.voce_audio?.id;return e?`/assets/${e}`:""});function $(e){if(!e.length)return"";return(e.find(e=>"anna"===(e.nome||"").trim().toLowerCase())||e[0]).id||""}async function P(){F.value=!0,T.value="";try{const e=await r.get("/items/voci_agente",{params:{fields:["id","nome","descrizione","id_elevenlabs","cliente","voce_audio.id","voce_audio.filename_download"],limit:-1,sort:["nome"]}});j.value=e?.data?.data||[];new Set(j.value.map(e=>e.id)).has(D.value)||(D.value=$(j.value))}catch(e){T.value="Errore caricamento voci agente",j.value=[]}finally{F.value=!1}}async function N(){T.value="";const e=D.value;if(!e)return;const n=await async function(){const e=t.selectedAzienda?.value;if(!e)return null;try{const n=await r.get("/items/clienti",{params:{fields:["id"],filter:{azienda:{_eq:e}},limit:1}});return n?.data?.data?.[0]?.id||null}catch(e){return null}}();if(!n)return void(T.value="Seleziona un cliente valido per associare la voce.");if((L.value?.cliente?.id??L.value?.cliente??null)!==n)try{await r.patch(`/items/voci_agente/${e}`,{cliente:n});const a=j.value.findIndex(n=>n.id===e);-1!==a&&(j.value[a].cliente=n)}catch(e){T.value="Errore durante l’associazione del cliente alla voce."}}return m(()=>{_(),P()}),u(()=>t.selectedAzienda?.value,(e,n)=>{promptValue.value="",firstMessageValue.value="",promptDraft.value="",firstMessageDraft.value="",promptId.value=null,k.value="",e&&_()},{immediate:!1}),u(()=>t.selectedAzienda?.value,()=>{D.value="",P()}),(e,n)=>(o(),i("div",mn,[l("div",hn,[l("div",xn,[n[9]||(n[9]=l("h3",{class:"prompt-title"},"Prompt",-1)),f(l("textarea",{"onUpdate:modelValue":n[0]||(n[0]=e=>S(d)?d.value=e:null),class:"prompt-textarea",readonly:!c(h),placeholder:"Scrivi qui il prompt del chatbot...",onFocus:n[1]||(n[1]=(...e)=>c(z)&&c(z)(...e))},null,40,yn),[[b,c(d)]]),l("div",wn,[l("button",{class:"btn-ghost",type:"button",disabled:!c(h),onClick:n[2]||(n[2]=(...e)=>c(E)&&c(E)(...e))}," Annulla ",8,kn),l("button",{class:"btn-primary",type:"button",disabled:!c(h),onClick:n[3]||(n[3]=(...e)=>c(q)&&c(q)(...e))}," Salva ",8,_n)]),n[10]||(n[10]=l("h3",{class:"prompt-title"},"Primo Messaggio",-1)),f(l("textarea",{"onUpdate:modelValue":n[4]||(n[4]=e=>S(p)?p.value=e:null),class:"prompt-textarea prompt-textarea--small",readonly:!c(w),rows:"2",placeholder:"Scrivi il primo messaggio...",onFocus:n[5]||(n[5]=(...e)=>c(C)&&c(C)(...e))},null,40,zn),[[b,c(p)]]),l("div",Cn,[l("button",{class:"btn-ghost",type:"button",disabled:!c(w),onClick:n[6]||(n[6]=(...e)=>c(I)&&c(I)(...e))}," Annulla ",8,En),l("button",{class:"btn-primary",type:"button",disabled:!c(w),onClick:n[7]||(n[7]=(...e)=>c(O)&&c(O)(...e))}," Salva ",8,Sn)]),c(k)?(o(),i("p",An,s(c(k)),1)):v("v-if",!0)]),l("aside",In,[l("div",qn,[n[13]||(n[13]=l("div",{class:"voice-panel-header"},[l("h3",{class:"voice-title"},"Voce Agente")],-1)),l("div",Rn,[l("div",On,s((L.value?.nome||"V").slice(0,1).toUpperCase()),1),l("div",jn,[l("div",Fn,s(L.value?.nome||"Seleziona una voce"),1),D.value&&D.value===M.value?(o(),i("div",Tn," Predefinita ")):v("v-if",!0)])]),n[14]||(n[14]=l("div",{class:"voice-divider","aria-hidden":"true"},null,-1)),l("div",Dn,[n[12]||(n[12]=l("label",{class:"voice-label",for:"voice-select"},"Seleziona voce",-1)),f(l("select",{id:"voice-select","onUpdate:modelValue":n[8]||(n[8]=e=>D.value=e),class:"voice-select",disabled:F.value,onChange:N},[n[11]||(n[11]=l("option",{value:""},"Seleziona una voce",-1)),(o(!0),i(x,null,y(j.value,e=>(o(),i("option",{key:e.id,value:e.id},s(e.nome||"Voce senza nome"),9,Mn))),128))],40,Ln),[[A,D.value]])]),F.value?(o(),i("p",Un,"Caricamento voci...")):j.value.length?v("v-if",!0):(o(),i("p",$n,"Nessuna voce disponibile.")),L.value?(o(),i("div",Pn,[l("p",Nn,s(L.value.descrizione||"Nessuna descrizione disponibile."),1),l("audio",{class:"voice-audio",controls:"",src:U.value},null,8,Vn),U.value?v("v-if",!0):(o(),i("p",Yn," Nessun audio disponibile per questa voce. "))])):v("v-if",!0),T.value?(o(),i("p",Bn,s(T.value),1)):v("v-if",!0)])])])]))}};var Wn=M(Qn,[["__scopeId","data-v-9905049a"]]);L("\n.iframe-modal[data-v-d62992fe] {\r\n  width: 1100px;\r\n  max-width: 95vw;\r\n  max-height: 90vh;\r\n  display: flex;\r\n  flex-direction: column;\n}\n.iframe-modal-body[data-v-d62992fe] {\r\n  padding: 0;\r\n  height: 75vh;\n}\n.embed-frame[data-v-d62992fe] {\r\n  width: 100%;\r\n  height: 70vh;\r\n  border: 0;\r\n  border-radius: 10px;\r\n  background: var(--background-page);\n}\n.embed-frame--modal[data-v-d62992fe] {\r\n  height: 75vh;\r\n  border-radius: 0;\n}\n.modal-title[data-v-d62992fe] {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  gap: 10px;\r\n  text-align: center;\n}\n.modal-title-text[data-v-d62992fe] {\r\n  font-weight: 700;\n}\n.faq-modal-actions[data-v-d62992fe] {\r\n  display: flex;\r\n  flex-direction: row;\r\n  flex-wrap: nowrap;\r\n  width: 100%;\r\n  justify-content: flex-end;\r\n  align-items: center;\r\n  gap: 8px;\n}\n.faq-modal-actions[data-v-d62992fe] .v-button {\r\n  width: auto;\r\n  min-width: 120px;\n}\r\n",{});const Hn={class:"modal-title-text"},Kn=["src"];var Jn=M({__name:"IframeModal",props:{open:{type:Boolean,default:!1},title:{type:String,default:""},icon:{type:String,default:"edit"},src:{type:String,default:""},saving:{type:Boolean,default:!1}},emits:["update:open","close","save"],setup(e){const n=a(null);function t(){const e=n.value;if(e)try{!function(e){if(!e)return;const n="ia-embed-style";if(e.getElementById(n))return;const a=e.createElement("style");a.id=n,a.textContent='\n    /* Hide Directus chrome (best-effort; selectors vary by version) */\n    .module-bar,\n    .module-nav,\n    .module-navigation,\n    .navigation,\n    aside,\n    nav,\n    [class*="sidebar"],\n    [class*="nav-"],\n    [class*="module-bar"],\n    [class*="module-nav"] {\n      display: none !important;\n    }\n\n    /* Remove outer paddings/margins */\n    html, body, #app {\n      height: 100% !important;\n      margin: 0 !important;\n      padding: 0 !important;\n      background: transparent !important;\n    }\n\n    /* Make main content use full width */\n    [class*="layout"] {\n      grid-template-columns: 1fr !important;\n    }\n\n    /* In modal, hide headers/toolbars for a cleaner form */\n    \n    header,\n    [class*="header"],\n    [class*="toolbar"],\n    [class*="actions"],\n    [class*="title"],\n    [class*="breadcrumbs"] {\n      display: none !important;\n    }\n  ',e.head?.appendChild(a)}(e.contentDocument)}catch{}}return(a,r)=>{const i=w("v-icon"),c=w("v-card-title"),u=w("v-card-text"),p=w("v-button"),f=w("v-card-actions"),v=w("v-card"),b=w("v-dialog");return o(),h(b,{"model-value":e.open,"onUpdate:modelValue":r[2]||(r[2]=e=>a.$emit("update:open",e)),onEsc:r[3]||(r[3]=e=>a.$emit("close"))},{default:z(()=>[d(v,{class:"iframe-modal"},{default:z(()=>[d(c,{class:"modal-title"},{default:z(()=>[d(i,{name:e.icon},null,8,["name"]),l("span",Hn,s(e.title),1)]),_:1}),d(u,{class:"iframe-modal-body"},{default:z(()=>[l("iframe",{ref_key:"iframeRef",ref:n,class:"embed-frame embed-frame--modal",src:e.src,onLoad:t},null,40,Kn)]),_:1}),d(f,{class:"faq-modal-actions"},{default:z(()=>[d(p,{onClick:r[0]||(r[0]=e=>a.$emit("close")),secondary:""},{default:z(()=>[...r[4]||(r[4]=[C("Annulla",-1)])]),_:1}),d(p,{onClick:r[1]||(r[1]=e=>a.$emit("save")),loading:e.saving},{default:z(()=>[...r[5]||(r[5]=[C("Salva",-1)])]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["model-value"])}}},[["__scopeId","data-v-d62992fe"]]);L('\n.company-selector-wrapper[data-v-2e84fe6a] {\r\n  position: relative;\n}\n.company-selector-header[data-v-2e84fe6a] {\r\n  position: fixed;\r\n  top: 20px;\r\n  right: 120px; /* Posizionato più a destra come nell\'immagine */\r\n  z-index: 100;\n}\n.azienda-select-button[data-v-2e84fe6a] {\r\n  font-size: 13px;\r\n  font-weight: 600;\r\n  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\r\n  overflow: visible;\n}\n.azienda-select-button[data-v-2e84fe6a] .v-button {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n  gap: 10px;\r\n  padding: 12px 16px;\r\n  min-height: 44px;\r\n  box-sizing: border-box;\r\n  border-radius: 10px;\r\n  font-weight: 600;\r\n  letter-spacing: -0.01em;\r\n  overflow: visible;\r\n  line-height: 1.5;\r\n  border: 1px solid var(--border-color-subdued, #e5e7eb);\r\n  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05), 0 1px 3px rgba(0, 0, 0, 0.1);\r\n  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n}\n.azienda-select-button[data-v-2e84fe6a] .v-button:hover {\r\n  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.07), 0 2px 4px rgba(0, 0, 0, 0.06);\r\n  transform: translateY(-1px);\r\n  border-color: var(--border-color, #d1d5db);\n}\n.azienda-select-button[data-v-2e84fe6a] .v-button:active {\r\n  transform: translateY(0);\r\n  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);\n}\n.azienda-select-button[data-v-2e84fe6a] .v-icon {\r\n  flex-shrink: 0;\r\n  width: 16px;\r\n  height: 16px;\r\n  display: inline-flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  overflow: visible;\r\n  vertical-align: middle;\r\n  transition: all 0.2s ease;\n}\n.azienda-select-button[data-v-2e84fe6a] .v-icon[name="business"] {\r\n  color: inherit;\r\n  opacity: 0.85;\r\n  margin: 0;\r\n  padding: 0;\n}\n.azienda-select-button[data-v-2e84fe6a] .v-icon[name="arrow_drop_down"] {\r\n  color: inherit;\r\n  opacity: 0.65;\r\n  width: 18px;\r\n  height: 18px;\r\n  transition: transform 0.2s ease;\n}\n.azienda-select-button[data-v-2e84fe6a] .v-button:hover .v-icon[name="arrow_drop_down"] {\r\n  opacity: 0.85;\n}\n.azienda-button-text[data-v-2e84fe6a] {\r\n  flex: 1;\r\n  text-align: left;\r\n  overflow: hidden;\r\n  text-overflow: ellipsis;\r\n  white-space: nowrap;\r\n  min-width: 0;\r\n  letter-spacing: -0.01em;\r\n  font-size: 13px;\r\n  line-height: 1.4;\n}\r\n\r\n/* Drawer Styles */\n.drawer-content[data-v-2e84fe6a] {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 16px;\r\n  padding: 8px;\n}\n.drawer-header[data-v-2e84fe6a] {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n  gap: 12px;\r\n  padding: 20px 24px;\r\n  background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%);\r\n  border-radius: 12px;\r\n  border: 1px solid var(--border-normal, #e8e8e8);\r\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);\n}\n.drawer-header-title[data-v-2e84fe6a] {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 10px;\r\n  font-size: 15px;\r\n  font-weight: 600;\r\n  color: var(--foreground, #1a1a1a);\r\n  flex: 1;\r\n  letter-spacing: -0.01em;\n}\n.drawer-header-title[data-v-2e84fe6a] .v-icon {\r\n  color: var(--foreground, #1a1a1a);\r\n  opacity: 0.8;\n}\n.drawer-header-actions[data-v-2e84fe6a] {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 8px;\n}\n.drawer-loading[data-v-2e84fe6a] {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  justify-content: center;\r\n  gap: 12px;\r\n  padding: 40px 20px;\r\n  color: var(--foreground-subdued, #6b7280);\n}\n.drawer-loading span[data-v-2e84fe6a] {\r\n  font-size: 14px;\n}\n.aziende-list[data-v-2e84fe6a] {\r\n  flex: 1;\r\n  overflow-y: auto;\n}\n.azienda-item[data-v-2e84fe6a] {\r\n  cursor: pointer;\r\n  transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);\r\n  border-radius: 8px;\r\n  margin-bottom: 4px;\n}\n.azienda-item[data-v-2e84fe6a]:hover {\r\n  background: var(--background-subdued, #f9fafb);\n}\n.azienda-item--active[data-v-2e84fe6a] {\r\n  background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%);\r\n  border-radius: 8px;\r\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.04);\r\n  border: 1px solid var(--border-normal, #e8e8e8);\n}\n.azienda-item--active[data-v-2e84fe6a] .v-list-item-content {\r\n  color: var(--foreground, #1a1a1a);\r\n  font-weight: 600;\r\n  letter-spacing: -0.01em;\n}\n.azienda-item--active[data-v-2e84fe6a] .v-icon {\r\n  color: var(--foreground, #1a1a1a);\r\n  opacity: 0.9;\n}\n.selected-azienda-info[data-v-2e84fe6a] {\r\n  margin-top: auto;\r\n  padding: 16px;\r\n  background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%);\r\n  border-radius: 12px;\r\n  border: 1px solid var(--border-normal, #e8e8e8);\r\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);\n}\n.selected-azienda-label[data-v-2e84fe6a] {\r\n  font-size: 12px;\r\n  font-weight: 600;\r\n  color: var(--foreground-subdued, #6b7280);\r\n  text-transform: uppercase;\r\n  letter-spacing: 0.5px;\r\n  margin-bottom: 8px;\n}\n.selected-azienda-name[data-v-2e84fe6a] {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 8px;\r\n  font-size: 15px;\r\n  font-weight: 600;\r\n  color: var(--foreground, #1a1a1a);\n}\n.selected-azienda-name[data-v-2e84fe6a] .v-icon {\r\n  color: var(--foreground, #1a1a1a);\n}\r\n',{});const Zn={class:"company-selector-wrapper"},Gn={class:"company-selector-header"},Xn={class:"azienda-button-text"},ea={class:"drawer-content"},na={class:"drawer-header"},aa={class:"drawer-header-title"},ta={class:"drawer-header-actions"},ra={key:0,class:"drawer-loading"},ia={key:4,class:"selected-azienda-info"},oa={class:"selected-azienda-name"},la="clienti";var sa=M({__name:"CompanySelector",emits:["selected"],setup(n,{expose:t,emit:r}){const u=e(),p=a([]),b=a(!1),k=a(null),E=R(),S=E.selectedAzienda,A=a(!1),q=g(()=>b.value?"Caricamento...":k.value?"Errore":`Aziende (${p.value.length})`);async function O(){b.value=!0,k.value=null;try{const e=await u.get(`/items/${la}`,{params:{fields:["azienda"],limit:-1}}),n=e?.data?.data||[],a=new Set;if(n.forEach(e=>{const n=e?.azienda;n&&"string"==typeof n&&n.trim()&&a.add(n.trim())}),p.value=Array.from(a).sort(),p.value.length>0&&!S.value){const e=localStorage.getItem("ia_module_selected_azienda");e&&p.value.includes(e)?E.setAzienda(e):E.setAzienda(p.value[0])}}catch(e){console.error("Error loading aziende:",e);const n=e?.response?.status,a=e?.response?.data?.errors?.[0]?.message||e?.message||"Errore sconosciuto";k.value=403===n?{title:"Accesso negato",message:`Non hai i permessi per accedere alla collection "${la}".`}:404===n?{title:"Collection non trovata",message:`La collection "${la}" non esiste in Directus.`}:{title:"Errore di caricamento",message:`Impossibile caricare le aziende: ${a}`},p.value=[]}finally{b.value=!1}}const j=r;function F(e){e&&"string"==typeof e&&(E.setAzienda(e),j("selected",e))}return t({selectedAzienda:S,selectAzienda:F,loadAziende:O}),m(()=>{O()}),(e,n)=>{const a=w("v-icon"),t=w("v-button"),r=w("v-progress-circular"),u=w("v-info"),g=w("v-list-item-icon"),m=w("v-list-item-title"),E=w("v-list-item-content"),R=w("v-list-item"),j=w("v-list"),T=w("v-drawer"),D=I("tooltip");return o(),i("div",Zn,[v(" Pulsante selezione azienda in alto a destra "),l("div",Gn,[f((o(),h(t,{secondary:!!c(S),type:c(S)?"secondary":"primary",onClick:n[0]||(n[0]=e=>A.value=!0),class:"azienda-select-button"},{default:z(()=>[d(a,{name:"business",left:""}),l("span",Xn,s(c(S)||"Seleziona azienda"),1),d(a,{name:"arrow_drop_down",right:""})]),_:1},8,["secondary","type"])),[[D,c(S)?"Cambia azienda":"Seleziona azienda"]])]),v(" Drawer per selezione aziende (destra) "),d(T,{modelValue:A.value,"onUpdate:modelValue":n[1]||(n[1]=e=>A.value=e),side:"right",title:q.value,width:"320"},{default:z(()=>[l("div",ea,[v(" Header con pulsanti "),l("div",na,[l("div",aa,[d(a,{name:"business"}),n[2]||(n[2]=l("span",null,"Seleziona Azienda",-1))]),l("div",ta,[f((o(),h(t,{icon:"",secondary:"",loading:b.value,onClick:O},{default:z(()=>[d(a,{name:"refresh"})]),_:1},8,["loading"])),[[D,"Aggiorna lista aziende"]])])]),v(" Loading State "),b.value?(o(),i("div",ra,[d(r,{indeterminate:""}),n[3]||(n[3]=l("span",null,"Caricamento aziende...",-1))])):k.value?(o(),i(x,{key:1},[v(" Error State "),d(u,{type:"danger",icon:"error",title:k.value.title||"Errore caricamento",text:k.value.message||""},{append:z(()=>[d(t,{onClick:O,loading:b.value},{default:z(()=>[...n[4]||(n[4]=[C("Riprova",-1)])]),_:1},8,["loading"])]),_:1},8,["title","text"])],2112)):0===p.value.length?(o(),i(x,{key:2},[v(" Empty State "),d(u,{icon:"info",title:"Nessuna azienda",text:"Non sono state trovate aziende nella collection clienti."})],2112)):(o(),i(x,{key:3},[v(" Lista Aziende "),d(j,{nav:"",class:"aziende-list"},{default:z(()=>[(o(!0),i(x,null,y(p.value,e=>(o(),h(R,{key:e,class:_(["azienda-item",{"azienda-item--active":c(S)===e}]),onClick:n=>F(e)},{default:z(()=>[d(g,null,{default:z(()=>[d(a,{name:c(S)===e?"check_circle":"business"},null,8,["name"])]),_:2},1024),d(E,null,{default:z(()=>[d(m,null,{default:z(()=>[C(s(e||"Senza nome"),1)]),_:2},1024)]),_:2},1024),c(S)===e?(o(),h(g,{key:0},{default:z(()=>[d(a,{name:"check"})]),_:1})):v("v-if",!0)]),_:2},1032,["class","onClick"]))),128))]),_:1})],2112)),v(" Azienda selezionata info "),c(S)?(o(),i("div",ia,[n[5]||(n[5]=l("div",{class:"selected-azienda-label"},"Azienda attualmente selezionata:",-1)),l("div",oa,[d(a,{name:"check_circle"}),l("span",null,s(c(S)),1)])])):v("v-if",!0)])]),_:1},8,["modelValue","title"])])}}},[["__scopeId","data-v-2e84fe6a"]]);L("\n.nav-item[data-v-55a5721d] {\n  cursor: pointer;\n  transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);\n  border-radius: 8px;\n}\n.nav-item[data-v-55a5721d]:hover {\n  background: var(--background-subdued, #f9fafb);\n}\n.nav-item.nav-item--active[data-v-55a5721d] {\n  background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%);\n  border-radius: 8px;\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.04);\n  border: 1px solid var(--border-normal, #e8e8e8);\n}\n.nav-item.nav-item--active[data-v-55a5721d] .v-list-item-content {\n  color: var(--foreground, #1a1a1a);\n  font-weight: 600;\n  letter-spacing: -0.01em;\n}\n.nav-item.nav-item--active[data-v-55a5721d] .v-icon {\n  color: var(--foreground, #1a1a1a);\n  opacity: 0.9;\n}\n",{});const da={key:0},ca={key:1};var ua=n({id:"ia",name:"IA",icon:"psychology",routes:[{path:"",component:M({__name:"module",setup(n){e();const{selectedAzienda:r,setAzienda:l}=function(){const e=a(null);if("undefined"!=typeof window){const n=localStorage.getItem("ia_module_selected_azienda");n&&(e.value=n)}return{selectedAzienda:e,setAzienda:function(n){e.value=n,"undefined"!=typeof window&&(n?localStorage.setItem("ia_module_selected_azienda",n):localStorage.removeItem("ia_module_selected_azienda"))},getAzienda:function(){return e.value}}}();t(q,{selectedAzienda:r,setAzienda:l});const s=a("base-conoscenza"),c=a(!1),u=a(""),p=a(""),f=a("add"),b=a(!1);function g(){c.value=!1,u.value=""}async function m(){b.value=!0,setTimeout(()=>{b.value=!1},800)}function x(e){l(e)}return"undefined"!=typeof window&&(window.__iaModuleIframeModal={open:(e,n,a)=>{u.value=e,p.value=n||"Modifica",f.value=a||"edit",c.value=!0},close:g}),(e,n)=>{const a=w("v-icon"),t=w("v-list-item-icon"),r=w("v-list-item-content"),l=w("v-list-item"),y=w("v-list"),k=w("private-view");return o(),h(k,{title:"Agente IA"},{navigation:z(()=>[d(y,{nav:""},{default:z(()=>[d(l,{class:_(["nav-item",{"nav-item--active":"base-conoscenza"===s.value}]),onClick:n[0]||(n[0]=e=>s.value="base-conoscenza")},{default:z(()=>[d(t,null,{default:z(()=>[d(a,{name:"auto_stories"})]),_:1}),d(r,null,{default:z(()=>[...n[3]||(n[3]=[C("Base di conoscenza",-1)])]),_:1})]),_:1},8,["class"]),d(l,{class:_(["nav-item",{"nav-item--active":"prompt"===s.value}]),onClick:n[1]||(n[1]=e=>s.value="prompt")},{default:z(()=>[d(t,null,{default:z(()=>[d(a,{name:"code"})]),_:1}),d(r,null,{default:z(()=>[...n[4]||(n[4]=[C("Prompt",-1)])]),_:1})]),_:1},8,["class"])]),_:1})]),default:z(()=>[d(sa,{onSelected:x}),"base-conoscenza"===s.value?(o(),i("div",da,[d(gn)])):v("v-if",!0),"prompt"===s.value?(o(),i("div",ca,[d(Wn)])):v("v-if",!0),d(Jn,{open:c.value,title:p.value,icon:f.value,src:u.value,saving:b.value,"onUpdate:open":n[2]||(n[2]=e=>c.value=e),onClose:g,onSave:m},null,8,["open","title","icon","src","saving"])]),_:1})}}},[["__scopeId","data-v-55a5721d"]])}]});export{ua as default};
